{
    "error_id": "58",
    "information": {
        "errors": [
            {
                "line": "801",
                "column": "69",
                "severity": "warning",
                "message": "',' is preceded with whitespace.",
                "source": "com.puppycrawl.tools.checkstyle.checks.whitespace.NoWhitespaceBeforeCheck"
            }
        ]
    },
    "source_code": "                            \"\" + (c.isNullable() ?\n                                    DatabaseMetaData.columnNullable :\n                                    DatabaseMetaData.columnNoNulls) ,\n                            // IS_COMPUTED\n                            \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n                            // SELECTIVITY",
    "results": [
        {
            "tool": "styler",
            "errors": [],
            "diff": "diff --git a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler/58/MetaTable.java\nindex e9dc5d4d9e..6e517f3ee0 100644\n--- a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java\n+++ b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler/58/MetaTable.java\n@@ -798,7 +798,7 @@ public class MetaTable extends Table {\n                             // NULLABLE\n                             \"\" + (c.isNullable() ?\n                                     DatabaseMetaData.columnNullable :\n-                                    DatabaseMetaData.columnNoNulls) ,\n+                                    DatabaseMetaData.columnNoNulls),\n                             // IS_COMPUTED\n                             \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n                             // SELECTIVITY\n",
            "diff_size": 1
        },
        {
            "tool": "intellij",
            "errors": [],
            "diff": "diff --git a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/intellij/58/MetaTable.java\nindex e9dc5d4d9e..51948d8289 100644\n--- a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java\n+++ b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/intellij/58/MetaTable.java\n@@ -3,6 +3,7 @@\n  * and the EPL 1.0 (http://h2database.com/html/license.html).\n  * Initial Developer: H2 Group\n  */\n+\n package org.h2.table;\n \n import java.io.ByteArrayInputStream;\n@@ -72,2015 +73,2025 @@ import org.h2.value.ValueStringIgnoreCase;\n  */\n public class MetaTable extends Table {\n \n-    /**\n-     * The approximate number of rows of a meta table.\n-     */\n-    public static final long ROW_COUNT_APPROXIMATION = 1000;\n+  /**\n+   * The approximate number of rows of a meta table.\n+   */\n+  public static final long ROW_COUNT_APPROXIMATION = 1000;\n \n-    private static final String CHARACTER_SET_NAME = \"Unicode\";\n+  private static final String CHARACTER_SET_NAME = \"Unicode\";\n \n-    private static final int TABLES = 0;\n-    private static final int COLUMNS = 1;\n-    private static final int INDEXES = 2;\n-    private static final int TABLE_TYPES = 3;\n-    private static final int TYPE_INFO = 4;\n-    private static final int CATALOGS = 5;\n-    private static final int SETTINGS = 6;\n-    private static final int HELP = 7;\n-    private static final int SEQUENCES = 8;\n-    private static final int USERS = 9;\n-    private static final int ROLES = 10;\n-    private static final int RIGHTS = 11;\n-    private static final int FUNCTION_ALIASES = 12;\n-    private static final int SCHEMATA = 13;\n-    private static final int TABLE_PRIVILEGES = 14;\n-    private static final int COLUMN_PRIVILEGES = 15;\n-    private static final int COLLATIONS = 16;\n-    private static final int VIEWS = 17;\n-    private static final int IN_DOUBT = 18;\n-    private static final int CROSS_REFERENCES = 19;\n-    private static final int CONSTRAINTS = 20;\n-    private static final int FUNCTION_COLUMNS = 21;\n-    private static final int CONSTANTS = 22;\n-    private static final int DOMAINS = 23;\n-    private static final int TRIGGERS = 24;\n-    private static final int SESSIONS = 25;\n-    private static final int LOCKS = 26;\n-    private static final int SESSION_STATE = 27;\n-    private static final int QUERY_STATISTICS = 28;\n-    private static final int META_TABLE_TYPE_COUNT = QUERY_STATISTICS + 1;\n+  private static final int TABLES = 0;\n+  private static final int COLUMNS = 1;\n+  private static final int INDEXES = 2;\n+  private static final int TABLE_TYPES = 3;\n+  private static final int TYPE_INFO = 4;\n+  private static final int CATALOGS = 5;\n+  private static final int SETTINGS = 6;\n+  private static final int HELP = 7;\n+  private static final int SEQUENCES = 8;\n+  private static final int USERS = 9;\n+  private static final int ROLES = 10;\n+  private static final int RIGHTS = 11;\n+  private static final int FUNCTION_ALIASES = 12;\n+  private static final int SCHEMATA = 13;\n+  private static final int TABLE_PRIVILEGES = 14;\n+  private static final int COLUMN_PRIVILEGES = 15;\n+  private static final int COLLATIONS = 16;\n+  private static final int VIEWS = 17;\n+  private static final int IN_DOUBT = 18;\n+  private static final int CROSS_REFERENCES = 19;\n+  private static final int CONSTRAINTS = 20;\n+  private static final int FUNCTION_COLUMNS = 21;\n+  private static final int CONSTANTS = 22;\n+  private static final int DOMAINS = 23;\n+  private static final int TRIGGERS = 24;\n+  private static final int SESSIONS = 25;\n+  private static final int LOCKS = 26;\n+  private static final int SESSION_STATE = 27;\n+  private static final int QUERY_STATISTICS = 28;\n+  private static final int META_TABLE_TYPE_COUNT = QUERY_STATISTICS + 1;\n \n-    private final int type;\n-    private final int indexColumn;\n-    private final MetaIndex metaIndex;\n+  private final int type;\n+  private final int indexColumn;\n+  private final MetaIndex metaIndex;\n \n-    /**\n-     * Create a new metadata table.\n-     *\n-     * @param schema the schema\n-     * @param id the object id\n-     * @param type the meta table type\n-     */\n-    public MetaTable(Schema schema, int id, int type) {\n-        // tableName will be set later\n-        super(schema, id, null, true, true);\n-        this.type = type;\n-        Column[] cols;\n-        String indexColumnName = null;\n-        switch (type) {\n-        case TABLES:\n-            setObjectName(\"TABLES\");\n-            cols = createColumns(\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"TABLE_TYPE\",\n-                    // extensions\n-                    \"STORAGE_TYPE\",\n-                    \"SQL\",\n-                    \"REMARKS\",\n-                    \"LAST_MODIFICATION BIGINT\",\n-                    \"ID INT\",\n-                    \"TYPE_NAME\",\n-                    \"TABLE_CLASS\",\n-                    \"ROW_COUNT_ESTIMATE BIGINT\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case COLUMNS:\n-            setObjectName(\"COLUMNS\");\n-            cols = createColumns(\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"COLUMN_NAME\",\n-                    \"ORDINAL_POSITION INT\",\n-                    \"COLUMN_DEFAULT\",\n-                    \"IS_NULLABLE\",\n-                    \"DATA_TYPE INT\",\n-                    \"CHARACTER_MAXIMUM_LENGTH INT\",\n-                    \"CHARACTER_OCTET_LENGTH INT\",\n-                    \"NUMERIC_PRECISION INT\",\n-                    \"NUMERIC_PRECISION_RADIX INT\",\n-                    \"NUMERIC_SCALE INT\",\n-                    \"CHARACTER_SET_NAME\",\n-                    \"COLLATION_NAME\",\n-                    // extensions\n-                    \"TYPE_NAME\",\n-                    \"NULLABLE INT\",\n-                    \"IS_COMPUTED BIT\",\n-                    \"SELECTIVITY INT\",\n-                    \"CHECK_CONSTRAINT\",\n-                    \"SEQUENCE_NAME\",\n-                    \"REMARKS\",\n-                    \"SOURCE_DATA_TYPE SMALLINT\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case INDEXES:\n-            setObjectName(\"INDEXES\");\n-            cols = createColumns(\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"NON_UNIQUE BIT\",\n-                    \"INDEX_NAME\",\n-                    \"ORDINAL_POSITION SMALLINT\",\n-                    \"COLUMN_NAME\",\n-                    \"CARDINALITY INT\",\n-                    \"PRIMARY_KEY BIT\",\n-                    \"INDEX_TYPE_NAME\",\n-                    \"IS_GENERATED BIT\",\n-                    \"INDEX_TYPE SMALLINT\",\n-                    \"ASC_OR_DESC\",\n-                    \"PAGES INT\",\n-                    \"FILTER_CONDITION\",\n-                    \"REMARKS\",\n-                    \"SQL\",\n-                    \"ID INT\",\n-                    \"SORT_TYPE INT\",\n-                    \"CONSTRAINT_NAME\",\n-                    \"INDEX_CLASS\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case TABLE_TYPES:\n-            setObjectName(\"TABLE_TYPES\");\n-            cols = createColumns(\"TYPE\");\n-            break;\n-        case TYPE_INFO:\n-            setObjectName(\"TYPE_INFO\");\n-            cols = createColumns(\n-                \"TYPE_NAME\",\n-                \"DATA_TYPE INT\",\n-                \"PRECISION INT\",\n-                \"PREFIX\",\n-                \"SUFFIX\",\n-                \"PARAMS\",\n-                \"AUTO_INCREMENT BIT\",\n-                \"MINIMUM_SCALE SMALLINT\",\n-                \"MAXIMUM_SCALE SMALLINT\",\n-                \"RADIX INT\",\n-                \"POS INT\",\n-                \"CASE_SENSITIVE BIT\",\n-                \"NULLABLE SMALLINT\",\n-                \"SEARCHABLE SMALLINT\"\n-            );\n-            break;\n-        case CATALOGS:\n-            setObjectName(\"CATALOGS\");\n-            cols = createColumns(\"CATALOG_NAME\");\n-            break;\n-        case SETTINGS:\n-            setObjectName(\"SETTINGS\");\n-            cols = createColumns(\"NAME\", \"VALUE\");\n-            break;\n-        case HELP:\n-            setObjectName(\"HELP\");\n-            cols = createColumns(\n-                    \"ID INT\",\n-                    \"SECTION\",\n-                    \"TOPIC\",\n-                    \"SYNTAX\",\n-                    \"TEXT\"\n-            );\n-            break;\n-        case SEQUENCES:\n-            setObjectName(\"SEQUENCES\");\n-            cols = createColumns(\n-                    \"SEQUENCE_CATALOG\",\n-                    \"SEQUENCE_SCHEMA\",\n-                    \"SEQUENCE_NAME\",\n-                    \"CURRENT_VALUE BIGINT\",\n-                    \"INCREMENT BIGINT\",\n-                    \"IS_GENERATED BIT\",\n-                    \"REMARKS\",\n-                    \"CACHE BIGINT\",\n-                    \"MIN_VALUE BIGINT\",\n-                    \"MAX_VALUE BIGINT\",\n-                    \"IS_CYCLE BIT\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case USERS:\n-            setObjectName(\"USERS\");\n-            cols = createColumns(\n-                    \"NAME\",\n-                    \"ADMIN\",\n-                    \"REMARKS\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case ROLES:\n-            setObjectName(\"ROLES\");\n-            cols = createColumns(\n-                    \"NAME\",\n-                    \"REMARKS\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case RIGHTS:\n-            setObjectName(\"RIGHTS\");\n-            cols = createColumns(\n-                    \"GRANTEE\",\n-                    \"GRANTEETYPE\",\n-                    \"GRANTEDROLE\",\n-                    \"RIGHTS\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"ID INT\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case FUNCTION_ALIASES:\n-            setObjectName(\"FUNCTION_ALIASES\");\n-            cols = createColumns(\n-                    \"ALIAS_CATALOG\",\n-                    \"ALIAS_SCHEMA\",\n-                    \"ALIAS_NAME\",\n-                    \"JAVA_CLASS\",\n-                    \"JAVA_METHOD\",\n-                    \"DATA_TYPE INT\",\n-                    \"TYPE_NAME\",\n-                    \"COLUMN_COUNT INT\",\n-                    \"RETURNS_RESULT SMALLINT\",\n-                    \"REMARKS\",\n-                    \"ID INT\",\n-                    \"SOURCE\"\n-            );\n-            break;\n-        case FUNCTION_COLUMNS:\n-            setObjectName(\"FUNCTION_COLUMNS\");\n-            cols = createColumns(\n-                    \"ALIAS_CATALOG\",\n-                    \"ALIAS_SCHEMA\",\n-                    \"ALIAS_NAME\",\n-                    \"JAVA_CLASS\",\n-                    \"JAVA_METHOD\",\n-                    \"COLUMN_COUNT INT\",\n-                    \"POS INT\",\n-                    \"COLUMN_NAME\",\n-                    \"DATA_TYPE INT\",\n-                    \"TYPE_NAME\",\n-                    \"PRECISION INT\",\n-                    \"SCALE SMALLINT\",\n-                    \"RADIX SMALLINT\",\n-                    \"NULLABLE SMALLINT\",\n-                    \"COLUMN_TYPE SMALLINT\",\n-                    \"REMARKS\",\n-                    \"COLUMN_DEFAULT\"\n-            );\n-            break;\n-        case SCHEMATA:\n-            setObjectName(\"SCHEMATA\");\n-            cols = createColumns(\n-                    \"CATALOG_NAME\",\n-                    \"SCHEMA_NAME\",\n-                    \"SCHEMA_OWNER\",\n-                    \"DEFAULT_CHARACTER_SET_NAME\",\n-                    \"DEFAULT_COLLATION_NAME\",\n-                    \"IS_DEFAULT BIT\",\n-                    \"REMARKS\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case TABLE_PRIVILEGES:\n-            setObjectName(\"TABLE_PRIVILEGES\");\n-            cols = createColumns(\n-                    \"GRANTOR\",\n-                    \"GRANTEE\",\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"PRIVILEGE_TYPE\",\n-                    \"IS_GRANTABLE\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case COLUMN_PRIVILEGES:\n-            setObjectName(\"COLUMN_PRIVILEGES\");\n-            cols = createColumns(\n-                    \"GRANTOR\",\n-                    \"GRANTEE\",\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"COLUMN_NAME\",\n-                    \"PRIVILEGE_TYPE\",\n-                    \"IS_GRANTABLE\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case COLLATIONS:\n-            setObjectName(\"COLLATIONS\");\n-            cols = createColumns(\n-                    \"NAME\",\n-                    \"KEY\"\n-            );\n-            break;\n-        case VIEWS:\n-            setObjectName(\"VIEWS\");\n-            cols = createColumns(\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"VIEW_DEFINITION\",\n-                    \"CHECK_OPTION\",\n-                    \"IS_UPDATABLE\",\n-                    \"STATUS\",\n-                    \"REMARKS\",\n-                    \"ID INT\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case IN_DOUBT:\n-            setObjectName(\"IN_DOUBT\");\n-            cols = createColumns(\n-                    \"TRANSACTION\",\n-                    \"STATE\"\n-            );\n-            break;\n-        case CROSS_REFERENCES:\n-            setObjectName(\"CROSS_REFERENCES\");\n-            cols = createColumns(\n-                    \"PKTABLE_CATALOG\",\n-                    \"PKTABLE_SCHEMA\",\n-                    \"PKTABLE_NAME\",\n-                    \"PKCOLUMN_NAME\",\n-                    \"FKTABLE_CATALOG\",\n-                    \"FKTABLE_SCHEMA\",\n-                    \"FKTABLE_NAME\",\n-                    \"FKCOLUMN_NAME\",\n-                    \"ORDINAL_POSITION SMALLINT\",\n-                    \"UPDATE_RULE SMALLINT\",\n-                    \"DELETE_RULE SMALLINT\",\n-                    \"FK_NAME\",\n-                    \"PK_NAME\",\n-                    \"DEFERRABILITY SMALLINT\"\n-            );\n-            indexColumnName = \"PKTABLE_NAME\";\n-            break;\n-        case CONSTRAINTS:\n-            setObjectName(\"CONSTRAINTS\");\n-            cols = createColumns(\n-                    \"CONSTRAINT_CATALOG\",\n-                    \"CONSTRAINT_SCHEMA\",\n-                    \"CONSTRAINT_NAME\",\n-                    \"CONSTRAINT_TYPE\",\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"UNIQUE_INDEX_NAME\",\n-                    \"CHECK_EXPRESSION\",\n-                    \"COLUMN_LIST\",\n-                    \"REMARKS\",\n-                    \"SQL\",\n-                    \"ID INT\"\n-            );\n-            indexColumnName = \"TABLE_NAME\";\n-            break;\n-        case CONSTANTS:\n-            setObjectName(\"CONSTANTS\");\n-            cols = createColumns(\n-                    \"CONSTANT_CATALOG\",\n-                    \"CONSTANT_SCHEMA\",\n-                    \"CONSTANT_NAME\",\n-                    \"DATA_TYPE INT\",\n-                    \"REMARKS\",\n-                    \"SQL\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case DOMAINS:\n-            setObjectName(\"DOMAINS\");\n-            cols = createColumns(\n-                    \"DOMAIN_CATALOG\",\n-                    \"DOMAIN_SCHEMA\",\n-                    \"DOMAIN_NAME\",\n-                    \"COLUMN_DEFAULT\",\n-                    \"IS_NULLABLE\",\n-                    \"DATA_TYPE INT\",\n-                    \"PRECISION INT\",\n-                    \"SCALE INT\",\n-                    \"TYPE_NAME\",\n-                    \"SELECTIVITY INT\",\n-                    \"CHECK_CONSTRAINT\",\n-                    \"REMARKS\",\n-                    \"SQL\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case TRIGGERS:\n-            setObjectName(\"TRIGGERS\");\n-            cols = createColumns(\n-                    \"TRIGGER_CATALOG\",\n-                    \"TRIGGER_SCHEMA\",\n-                    \"TRIGGER_NAME\",\n-                    \"TRIGGER_TYPE\",\n-                    \"TABLE_CATALOG\",\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"BEFORE BIT\",\n-                    \"JAVA_CLASS\",\n-                    \"QUEUE_SIZE INT\",\n-                    \"NO_WAIT BIT\",\n-                    \"REMARKS\",\n-                    \"SQL\",\n-                    \"ID INT\"\n-            );\n-            break;\n-        case SESSIONS: {\n-            setObjectName(\"SESSIONS\");\n-            cols = createColumns(\n-                    \"ID INT\",\n-                    \"USER_NAME\",\n-                    \"SESSION_START\",\n-                    \"STATEMENT\",\n-                    \"STATEMENT_START\",\n-                    \"CONTAINS_UNCOMMITTED\"\n-            );\n-            break;\n-        }\n-        case LOCKS: {\n-            setObjectName(\"LOCKS\");\n-            cols = createColumns(\n-                    \"TABLE_SCHEMA\",\n-                    \"TABLE_NAME\",\n-                    \"SESSION_ID INT\",\n-                    \"LOCK_TYPE\"\n-            );\n-            break;\n-        }\n-        case SESSION_STATE: {\n-            setObjectName(\"SESSION_STATE\");\n-            cols = createColumns(\n-                    \"KEY\",\n-                    \"SQL\"\n-            );\n-            break;\n-        }\n-        case QUERY_STATISTICS: {\n-            setObjectName(\"QUERY_STATISTICS\");\n-            cols = createColumns(\n-                    \"SQL_STATEMENT\",\n-                    \"EXECUTION_COUNT INT\",\n-                    \"MIN_EXECUTION_TIME LONG\",\n-                    \"MAX_EXECUTION_TIME LONG\",\n-                    \"CUMULATIVE_EXECUTION_TIME LONG\",\n-                    \"AVERAGE_EXECUTION_TIME DOUBLE\",\n-                    \"STD_DEV_EXECUTION_TIME DOUBLE\",\n-                    \"MIN_ROW_COUNT INT\",\n-                    \"MAX_ROW_COUNT INT\",\n-                    \"CUMULATIVE_ROW_COUNT LONG\",\n-                    \"AVERAGE_ROW_COUNT DOUBLE\",\n-                    \"STD_DEV_ROW_COUNT DOUBLE\"\n-            );\n-            break;\n-        }\n-        default:\n-            throw DbException.throwInternalError(\"type=\"+type);\n-        }\n-        setColumns(cols);\n-\n-        if (indexColumnName == null) {\n-            indexColumn = -1;\n-            metaIndex = null;\n-        } else {\n-            indexColumn = getColumn(indexColumnName).getColumnId();\n-            IndexColumn[] indexCols = IndexColumn.wrap(\n-                    new Column[] { cols[indexColumn] });\n-            metaIndex = new MetaIndex(this, indexCols, false);\n-        }\n+  /**\n+   * Create a new metadata table.\n+   *\n+   * @param schema the schema\n+   * @param id     the object id\n+   * @param type   the meta table type\n+   */\n+  public MetaTable(Schema schema, int id, int type) {\n+    // tableName will be set later\n+    super(schema, id, null, true, true);\n+    this.type = type;\n+    Column[] cols;\n+    String indexColumnName = null;\n+    switch (type) {\n+      case TABLES:\n+        setObjectName(\"TABLES\");\n+        cols = createColumns(\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"TABLE_TYPE\",\n+            // extensions\n+            \"STORAGE_TYPE\",\n+            \"SQL\",\n+            \"REMARKS\",\n+            \"LAST_MODIFICATION BIGINT\",\n+            \"ID INT\",\n+            \"TYPE_NAME\",\n+            \"TABLE_CLASS\",\n+            \"ROW_COUNT_ESTIMATE BIGINT\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case COLUMNS:\n+        setObjectName(\"COLUMNS\");\n+        cols = createColumns(\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"COLUMN_NAME\",\n+            \"ORDINAL_POSITION INT\",\n+            \"COLUMN_DEFAULT\",\n+            \"IS_NULLABLE\",\n+            \"DATA_TYPE INT\",\n+            \"CHARACTER_MAXIMUM_LENGTH INT\",\n+            \"CHARACTER_OCTET_LENGTH INT\",\n+            \"NUMERIC_PRECISION INT\",\n+            \"NUMERIC_PRECISION_RADIX INT\",\n+            \"NUMERIC_SCALE INT\",\n+            \"CHARACTER_SET_NAME\",\n+            \"COLLATION_NAME\",\n+            // extensions\n+            \"TYPE_NAME\",\n+            \"NULLABLE INT\",\n+            \"IS_COMPUTED BIT\",\n+            \"SELECTIVITY INT\",\n+            \"CHECK_CONSTRAINT\",\n+            \"SEQUENCE_NAME\",\n+            \"REMARKS\",\n+            \"SOURCE_DATA_TYPE SMALLINT\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case INDEXES:\n+        setObjectName(\"INDEXES\");\n+        cols = createColumns(\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"NON_UNIQUE BIT\",\n+            \"INDEX_NAME\",\n+            \"ORDINAL_POSITION SMALLINT\",\n+            \"COLUMN_NAME\",\n+            \"CARDINALITY INT\",\n+            \"PRIMARY_KEY BIT\",\n+            \"INDEX_TYPE_NAME\",\n+            \"IS_GENERATED BIT\",\n+            \"INDEX_TYPE SMALLINT\",\n+            \"ASC_OR_DESC\",\n+            \"PAGES INT\",\n+            \"FILTER_CONDITION\",\n+            \"REMARKS\",\n+            \"SQL\",\n+            \"ID INT\",\n+            \"SORT_TYPE INT\",\n+            \"CONSTRAINT_NAME\",\n+            \"INDEX_CLASS\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case TABLE_TYPES:\n+        setObjectName(\"TABLE_TYPES\");\n+        cols = createColumns(\"TYPE\");\n+        break;\n+      case TYPE_INFO:\n+        setObjectName(\"TYPE_INFO\");\n+        cols = createColumns(\n+            \"TYPE_NAME\",\n+            \"DATA_TYPE INT\",\n+            \"PRECISION INT\",\n+            \"PREFIX\",\n+            \"SUFFIX\",\n+            \"PARAMS\",\n+            \"AUTO_INCREMENT BIT\",\n+            \"MINIMUM_SCALE SMALLINT\",\n+            \"MAXIMUM_SCALE SMALLINT\",\n+            \"RADIX INT\",\n+            \"POS INT\",\n+            \"CASE_SENSITIVE BIT\",\n+            \"NULLABLE SMALLINT\",\n+            \"SEARCHABLE SMALLINT\"\n+        );\n+        break;\n+      case CATALOGS:\n+        setObjectName(\"CATALOGS\");\n+        cols = createColumns(\"CATALOG_NAME\");\n+        break;\n+      case SETTINGS:\n+        setObjectName(\"SETTINGS\");\n+        cols = createColumns(\"NAME\", \"VALUE\");\n+        break;\n+      case HELP:\n+        setObjectName(\"HELP\");\n+        cols = createColumns(\n+            \"ID INT\",\n+            \"SECTION\",\n+            \"TOPIC\",\n+            \"SYNTAX\",\n+            \"TEXT\"\n+        );\n+        break;\n+      case SEQUENCES:\n+        setObjectName(\"SEQUENCES\");\n+        cols = createColumns(\n+            \"SEQUENCE_CATALOG\",\n+            \"SEQUENCE_SCHEMA\",\n+            \"SEQUENCE_NAME\",\n+            \"CURRENT_VALUE BIGINT\",\n+            \"INCREMENT BIGINT\",\n+            \"IS_GENERATED BIT\",\n+            \"REMARKS\",\n+            \"CACHE BIGINT\",\n+            \"MIN_VALUE BIGINT\",\n+            \"MAX_VALUE BIGINT\",\n+            \"IS_CYCLE BIT\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case USERS:\n+        setObjectName(\"USERS\");\n+        cols = createColumns(\n+            \"NAME\",\n+            \"ADMIN\",\n+            \"REMARKS\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case ROLES:\n+        setObjectName(\"ROLES\");\n+        cols = createColumns(\n+            \"NAME\",\n+            \"REMARKS\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case RIGHTS:\n+        setObjectName(\"RIGHTS\");\n+        cols = createColumns(\n+            \"GRANTEE\",\n+            \"GRANTEETYPE\",\n+            \"GRANTEDROLE\",\n+            \"RIGHTS\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"ID INT\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case FUNCTION_ALIASES:\n+        setObjectName(\"FUNCTION_ALIASES\");\n+        cols = createColumns(\n+            \"ALIAS_CATALOG\",\n+            \"ALIAS_SCHEMA\",\n+            \"ALIAS_NAME\",\n+            \"JAVA_CLASS\",\n+            \"JAVA_METHOD\",\n+            \"DATA_TYPE INT\",\n+            \"TYPE_NAME\",\n+            \"COLUMN_COUNT INT\",\n+            \"RETURNS_RESULT SMALLINT\",\n+            \"REMARKS\",\n+            \"ID INT\",\n+            \"SOURCE\"\n+        );\n+        break;\n+      case FUNCTION_COLUMNS:\n+        setObjectName(\"FUNCTION_COLUMNS\");\n+        cols = createColumns(\n+            \"ALIAS_CATALOG\",\n+            \"ALIAS_SCHEMA\",\n+            \"ALIAS_NAME\",\n+            \"JAVA_CLASS\",\n+            \"JAVA_METHOD\",\n+            \"COLUMN_COUNT INT\",\n+            \"POS INT\",\n+            \"COLUMN_NAME\",\n+            \"DATA_TYPE INT\",\n+            \"TYPE_NAME\",\n+            \"PRECISION INT\",\n+            \"SCALE SMALLINT\",\n+            \"RADIX SMALLINT\",\n+            \"NULLABLE SMALLINT\",\n+            \"COLUMN_TYPE SMALLINT\",\n+            \"REMARKS\",\n+            \"COLUMN_DEFAULT\"\n+        );\n+        break;\n+      case SCHEMATA:\n+        setObjectName(\"SCHEMATA\");\n+        cols = createColumns(\n+            \"CATALOG_NAME\",\n+            \"SCHEMA_NAME\",\n+            \"SCHEMA_OWNER\",\n+            \"DEFAULT_CHARACTER_SET_NAME\",\n+            \"DEFAULT_COLLATION_NAME\",\n+            \"IS_DEFAULT BIT\",\n+            \"REMARKS\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case TABLE_PRIVILEGES:\n+        setObjectName(\"TABLE_PRIVILEGES\");\n+        cols = createColumns(\n+            \"GRANTOR\",\n+            \"GRANTEE\",\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"PRIVILEGE_TYPE\",\n+            \"IS_GRANTABLE\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case COLUMN_PRIVILEGES:\n+        setObjectName(\"COLUMN_PRIVILEGES\");\n+        cols = createColumns(\n+            \"GRANTOR\",\n+            \"GRANTEE\",\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"COLUMN_NAME\",\n+            \"PRIVILEGE_TYPE\",\n+            \"IS_GRANTABLE\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case COLLATIONS:\n+        setObjectName(\"COLLATIONS\");\n+        cols = createColumns(\n+            \"NAME\",\n+            \"KEY\"\n+        );\n+        break;\n+      case VIEWS:\n+        setObjectName(\"VIEWS\");\n+        cols = createColumns(\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"VIEW_DEFINITION\",\n+            \"CHECK_OPTION\",\n+            \"IS_UPDATABLE\",\n+            \"STATUS\",\n+            \"REMARKS\",\n+            \"ID INT\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case IN_DOUBT:\n+        setObjectName(\"IN_DOUBT\");\n+        cols = createColumns(\n+            \"TRANSACTION\",\n+            \"STATE\"\n+        );\n+        break;\n+      case CROSS_REFERENCES:\n+        setObjectName(\"CROSS_REFERENCES\");\n+        cols = createColumns(\n+            \"PKTABLE_CATALOG\",\n+            \"PKTABLE_SCHEMA\",\n+            \"PKTABLE_NAME\",\n+            \"PKCOLUMN_NAME\",\n+            \"FKTABLE_CATALOG\",\n+            \"FKTABLE_SCHEMA\",\n+            \"FKTABLE_NAME\",\n+            \"FKCOLUMN_NAME\",\n+            \"ORDINAL_POSITION SMALLINT\",\n+            \"UPDATE_RULE SMALLINT\",\n+            \"DELETE_RULE SMALLINT\",\n+            \"FK_NAME\",\n+            \"PK_NAME\",\n+            \"DEFERRABILITY SMALLINT\"\n+        );\n+        indexColumnName = \"PKTABLE_NAME\";\n+        break;\n+      case CONSTRAINTS:\n+        setObjectName(\"CONSTRAINTS\");\n+        cols = createColumns(\n+            \"CONSTRAINT_CATALOG\",\n+            \"CONSTRAINT_SCHEMA\",\n+            \"CONSTRAINT_NAME\",\n+            \"CONSTRAINT_TYPE\",\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"UNIQUE_INDEX_NAME\",\n+            \"CHECK_EXPRESSION\",\n+            \"COLUMN_LIST\",\n+            \"REMARKS\",\n+            \"SQL\",\n+            \"ID INT\"\n+        );\n+        indexColumnName = \"TABLE_NAME\";\n+        break;\n+      case CONSTANTS:\n+        setObjectName(\"CONSTANTS\");\n+        cols = createColumns(\n+            \"CONSTANT_CATALOG\",\n+            \"CONSTANT_SCHEMA\",\n+            \"CONSTANT_NAME\",\n+            \"DATA_TYPE INT\",\n+            \"REMARKS\",\n+            \"SQL\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case DOMAINS:\n+        setObjectName(\"DOMAINS\");\n+        cols = createColumns(\n+            \"DOMAIN_CATALOG\",\n+            \"DOMAIN_SCHEMA\",\n+            \"DOMAIN_NAME\",\n+            \"COLUMN_DEFAULT\",\n+            \"IS_NULLABLE\",\n+            \"DATA_TYPE INT\",\n+            \"PRECISION INT\",\n+            \"SCALE INT\",\n+            \"TYPE_NAME\",\n+            \"SELECTIVITY INT\",\n+            \"CHECK_CONSTRAINT\",\n+            \"REMARKS\",\n+            \"SQL\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case TRIGGERS:\n+        setObjectName(\"TRIGGERS\");\n+        cols = createColumns(\n+            \"TRIGGER_CATALOG\",\n+            \"TRIGGER_SCHEMA\",\n+            \"TRIGGER_NAME\",\n+            \"TRIGGER_TYPE\",\n+            \"TABLE_CATALOG\",\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"BEFORE BIT\",\n+            \"JAVA_CLASS\",\n+            \"QUEUE_SIZE INT\",\n+            \"NO_WAIT BIT\",\n+            \"REMARKS\",\n+            \"SQL\",\n+            \"ID INT\"\n+        );\n+        break;\n+      case SESSIONS: {\n+        setObjectName(\"SESSIONS\");\n+        cols = createColumns(\n+            \"ID INT\",\n+            \"USER_NAME\",\n+            \"SESSION_START\",\n+            \"STATEMENT\",\n+            \"STATEMENT_START\",\n+            \"CONTAINS_UNCOMMITTED\"\n+        );\n+        break;\n+      }\n+      case LOCKS: {\n+        setObjectName(\"LOCKS\");\n+        cols = createColumns(\n+            \"TABLE_SCHEMA\",\n+            \"TABLE_NAME\",\n+            \"SESSION_ID INT\",\n+            \"LOCK_TYPE\"\n+        );\n+        break;\n+      }\n+      case SESSION_STATE: {\n+        setObjectName(\"SESSION_STATE\");\n+        cols = createColumns(\n+            \"KEY\",\n+            \"SQL\"\n+        );\n+        break;\n+      }\n+      case QUERY_STATISTICS: {\n+        setObjectName(\"QUERY_STATISTICS\");\n+        cols = createColumns(\n+            \"SQL_STATEMENT\",\n+            \"EXECUTION_COUNT INT\",\n+            \"MIN_EXECUTION_TIME LONG\",\n+            \"MAX_EXECUTION_TIME LONG\",\n+            \"CUMULATIVE_EXECUTION_TIME LONG\",\n+            \"AVERAGE_EXECUTION_TIME DOUBLE\",\n+            \"STD_DEV_EXECUTION_TIME DOUBLE\",\n+            \"MIN_ROW_COUNT INT\",\n+            \"MAX_ROW_COUNT INT\",\n+            \"CUMULATIVE_ROW_COUNT LONG\",\n+            \"AVERAGE_ROW_COUNT DOUBLE\",\n+            \"STD_DEV_ROW_COUNT DOUBLE\"\n+        );\n+        break;\n+      }\n+      default:\n+        throw DbException.throwInternalError(\"type=\" + type);\n     }\n+    setColumns(cols);\n \n-    private Column[] createColumns(String... names) {\n-        Column[] cols = new Column[names.length];\n-        for (int i = 0; i < names.length; i++) {\n-            String nameType = names[i];\n-            int idx = nameType.indexOf(' ');\n-            int dataType;\n-            String name;\n-            if (idx < 0) {\n-                dataType = database.getMode().lowerCaseIdentifiers ?\n-                        Value.STRING_IGNORECASE : Value.STRING;\n-                name = nameType;\n-            } else {\n-                dataType = DataType.getTypeByName(nameType.substring(idx + 1)).type;\n-                name = nameType.substring(0, idx);\n-            }\n-            cols[i] = new Column(name, dataType);\n-        }\n-        return cols;\n+    if (indexColumnName == null) {\n+      indexColumn = -1;\n+      metaIndex = null;\n+    } else {\n+      indexColumn = getColumn(indexColumnName).getColumnId();\n+      IndexColumn[] indexCols = IndexColumn.wrap(\n+          new Column[] {cols[indexColumn]});\n+      metaIndex = new MetaIndex(this, indexCols, false);\n     }\n+  }\n \n-    @Override\n-    public String getDropSQL() {\n-        return null;\n+  private Column[] createColumns(String... names) {\n+    Column[] cols = new Column[names.length];\n+    for (int i = 0; i < names.length; i++) {\n+      String nameType = names[i];\n+      int idx = nameType.indexOf(' ');\n+      int dataType;\n+      String name;\n+      if (idx < 0) {\n+        dataType = database.getMode().lowerCaseIdentifiers ?\n+            Value.STRING_IGNORECASE : Value.STRING;\n+        name = nameType;\n+      } else {\n+        dataType = DataType.getTypeByName(nameType.substring(idx + 1)).type;\n+        name = nameType.substring(0, idx);\n+      }\n+      cols[i] = new Column(name, dataType);\n     }\n+    return cols;\n+  }\n \n-    @Override\n-    public String getCreateSQL() {\n-        return null;\n-    }\n+  @Override\n+  public String getDropSQL() {\n+    return null;\n+  }\n \n-    @Override\n-    public Index addIndex(Session session, String indexName, int indexId,\n-            IndexColumn[] cols, IndexType indexType, boolean create,\n-            String indexComment) {\n-        throw DbException.getUnsupportedException(\"META\");\n-    }\n+  @Override\n+  public String getCreateSQL() {\n+    return null;\n+  }\n \n-    @Override\n-    public boolean lock(Session session, boolean exclusive, boolean forceLockEvenInMvcc) {\n-        // nothing to do\n-        return false;\n-    }\n+  @Override\n+  public Index addIndex(Session session, String indexName, int indexId,\n+                        IndexColumn[] cols, IndexType indexType, boolean create,\n+                        String indexComment) {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public boolean isLockedExclusively() {\n-        return false;\n-    }\n+  @Override\n+  public boolean lock(Session session, boolean exclusive,\n+                      boolean forceLockEvenInMvcc) {\n+    // nothing to do\n+    return false;\n+  }\n \n-    private String identifier(String s) {\n-        if (database.getMode().lowerCaseIdentifiers) {\n-            s = s == null ? null : StringUtils.toLowerEnglish(s);\n-        }\n-        return s;\n-    }\n+  @Override\n+  public boolean isLockedExclusively() {\n+    return false;\n+  }\n \n-    private ArrayList<Table> getAllTables(Session session) {\n-        ArrayList<Table> tables = database.getAllTablesAndViews(true);\n-        ArrayList<Table> tempTables = session.getLocalTempTables();\n-        tables.addAll(tempTables);\n-        return tables;\n+  private String identifier(String s) {\n+    if (database.getMode().lowerCaseIdentifiers) {\n+      s = s == null ? null : StringUtils.toLowerEnglish(s);\n     }\n+    return s;\n+  }\n \n-    private ArrayList<Table> getTablesByName(Session session, String tableName) {\n-        if (database.getMode().lowerCaseIdentifiers) {\n-            tableName = StringUtils.toUpperEnglish(tableName);\n-        }\n-        ArrayList<Table> tables = database.getTableOrViewByName(tableName);\n-        for (Table temp : session.getLocalTempTables()) {\n-            if (temp.getName().equals(tableName)) {\n-                tables.add(temp);\n-            }\n-        }\n-        return tables;\n-    }\n+  private ArrayList<Table> getAllTables(Session session) {\n+    ArrayList<Table> tables = database.getAllTablesAndViews(true);\n+    ArrayList<Table> tempTables = session.getLocalTempTables();\n+    tables.addAll(tempTables);\n+    return tables;\n+  }\n \n-    private boolean checkIndex(Session session, String value, Value indexFrom,\n-            Value indexTo) {\n-        if (value == null || (indexFrom == null && indexTo == null)) {\n-            return true;\n-        }\n-        Database db = session.getDatabase();\n-        Value v;\n-        if (database.getMode().lowerCaseIdentifiers) {\n-            v = ValueStringIgnoreCase.get(value);\n-        } else {\n-            v = ValueString.get(value);\n-        }\n-        if (indexFrom != null && db.compare(v, indexFrom) < 0) {\n-            return false;\n-        }\n-        if (indexTo != null && db.compare(v, indexTo) > 0) {\n-            return false;\n-        }\n-        return true;\n+  private ArrayList<Table> getTablesByName(Session session, String tableName) {\n+    if (database.getMode().lowerCaseIdentifiers) {\n+      tableName = StringUtils.toUpperEnglish(tableName);\n     }\n-\n-    private static String replaceNullWithEmpty(String s) {\n-        return s == null ? \"\" : s;\n+    ArrayList<Table> tables = database.getTableOrViewByName(tableName);\n+    for (Table temp : session.getLocalTempTables()) {\n+      if (temp.getName().equals(tableName)) {\n+        tables.add(temp);\n+      }\n     }\n+    return tables;\n+  }\n \n-    private boolean hideTable(Table table, Session session) {\n-        return table.isHidden() && session != database.getSystemSession();\n+  private boolean checkIndex(Session session, String value, Value indexFrom,\n+                             Value indexTo) {\n+    if (value == null || (indexFrom == null && indexTo == null)) {\n+      return true;\n+    }\n+    Database db = session.getDatabase();\n+    Value v;\n+    if (database.getMode().lowerCaseIdentifiers) {\n+      v = ValueStringIgnoreCase.get(value);\n+    } else {\n+      v = ValueString.get(value);\n     }\n+    if (indexFrom != null && db.compare(v, indexFrom) < 0) {\n+      return false;\n+    }\n+    if (indexTo != null && db.compare(v, indexTo) > 0) {\n+      return false;\n+    }\n+    return true;\n+  }\n \n-    /**\n-     * Generate the data for the given metadata table using the given first and\n-     * last row filters.\n-     *\n-     * @param session the session\n-     * @param first the first row to return\n-     * @param last the last row to return\n-     * @return the generated rows\n-     */\n-    public ArrayList<Row> generateRows(Session session, SearchRow first,\n-            SearchRow last) {\n-        Value indexFrom = null, indexTo = null;\n+  private static String replaceNullWithEmpty(String s) {\n+    return s == null ? \"\" : s;\n+  }\n \n-        if (indexColumn >= 0) {\n-            if (first != null) {\n-                indexFrom = first.getValue(indexColumn);\n-            }\n-            if (last != null) {\n-                indexTo = last.getValue(indexColumn);\n-            }\n-        }\n+  private boolean hideTable(Table table, Session session) {\n+    return table.isHidden() && session != database.getSystemSession();\n+  }\n \n-        ArrayList<Row> rows = New.arrayList();\n-        String catalog = identifier(database.getShortName());\n-        boolean admin = session.getUser().isAdmin();\n-        switch (type) {\n-        case TABLES: {\n-            for (Table table : getAllTables(session)) {\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                if (hideTable(table, session)) {\n-                    continue;\n-                }\n-                String storageType;\n-                if (table.isTemporary()) {\n-                    if (table.isGlobalTemporary()) {\n-                        storageType = \"GLOBAL TEMPORARY\";\n-                    } else {\n-                        storageType = \"LOCAL TEMPORARY\";\n-                    }\n-                } else {\n-                    storageType = table.isPersistIndexes() ?\n-                            \"CACHED\" : \"MEMORY\";\n-                }\n-                String sql = table.getCreateSQL();\n-                if (!admin) {\n-                    if (sql != null && sql.contains(JdbcSQLException.HIDE_SQL)) {\n-                        // hide the password of linked tables\n-                        sql = \"-\";\n-                    }\n-                }\n-                add(rows,\n-                        // TABLE_CATALOG\n-                        catalog,\n-                        // TABLE_SCHEMA\n-                        identifier(table.getSchema().getName()),\n-                        // TABLE_NAME\n-                        tableName,\n-                        // TABLE_TYPE\n-                        table.getTableType(),\n-                        // STORAGE_TYPE\n-                        storageType,\n-                        // SQL\n-                        sql,\n-                        // REMARKS\n-                        replaceNullWithEmpty(table.getComment()),\n-                        // LAST_MODIFICATION\n-                        \"\" + table.getMaxDataModificationId(),\n-                        // ID\n-                        \"\" + table.getId(),\n-                        // TYPE_NAME\n-                        null,\n-                        // TABLE_CLASS\n-                        table.getClass().getName(),\n-                        // ROW_COUNT_ESTIMATE\n-                        \"\" + table.getRowCountApproximation()\n-                );\n-            }\n-            break;\n-        }\n-        case COLUMNS: {\n-            // reduce the number of tables to scan - makes some metadata queries\n-            // 10x faster\n-            final ArrayList<Table> tablesToList;\n-            if (indexFrom != null && indexTo != null && indexFrom.equals(indexTo)) {\n-                String tableName = identifier(indexFrom.getString());\n-                tablesToList = getTablesByName(session, tableName);\n+  /**\n+   * Generate the data for the given metadata table using the given first and\n+   * last row filters.\n+   *\n+   * @param session the session\n+   * @param first   the first row to return\n+   * @param last    the last row to return\n+   * @return the generated rows\n+   */\n+  public ArrayList<Row> generateRows(Session session, SearchRow first,\n+                                     SearchRow last) {\n+    Value indexFrom = null, indexTo = null;\n+\n+    if (indexColumn >= 0) {\n+      if (first != null) {\n+        indexFrom = first.getValue(indexColumn);\n+      }\n+      if (last != null) {\n+        indexTo = last.getValue(indexColumn);\n+      }\n+    }\n+\n+    ArrayList<Row> rows = New.arrayList();\n+    String catalog = identifier(database.getShortName());\n+    boolean admin = session.getUser().isAdmin();\n+    switch (type) {\n+      case TABLES: {\n+        for (Table table : getAllTables(session)) {\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          if (hideTable(table, session)) {\n+            continue;\n+          }\n+          String storageType;\n+          if (table.isTemporary()) {\n+            if (table.isGlobalTemporary()) {\n+              storageType = \"GLOBAL TEMPORARY\";\n             } else {\n-                tablesToList = getAllTables(session);\n+              storageType = \"LOCAL TEMPORARY\";\n             }\n-            for (Table table : tablesToList) {\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                if (hideTable(table, session)) {\n-                    continue;\n-                }\n-                Column[] cols = table.getColumns();\n-                String collation = database.getCompareMode().getName();\n-                for (int j = 0; j < cols.length; j++) {\n-                    Column c = cols[j];\n-                    Sequence sequence = c.getSequence();\n-                    add(rows,\n-                            // TABLE_CATALOG\n-                            catalog,\n-                            // TABLE_SCHEMA\n-                            identifier(table.getSchema().getName()),\n-                            // TABLE_NAME\n-                            tableName,\n-                            // COLUMN_NAME\n-                            identifier(c.getName()),\n-                            // ORDINAL_POSITION\n-                            String.valueOf(j + 1),\n-                            // COLUMN_DEFAULT\n-                            c.getDefaultSQL(),\n-                            // IS_NULLABLE\n-                            c.isNullable() ? \"YES\" : \"NO\",\n-                            // DATA_TYPE\n-                            \"\" + DataType.convertTypeToSQLType(c.getType()),\n-                            // CHARACTER_MAXIMUM_LENGTH\n-                            \"\" + c.getPrecisionAsInt(),\n-                            // CHARACTER_OCTET_LENGTH\n-                            \"\" + c.getPrecisionAsInt(),\n-                            // NUMERIC_PRECISION\n-                            \"\" + c.getPrecisionAsInt(),\n-                            // NUMERIC_PRECISION_RADIX\n-                            \"10\",\n-                            // NUMERIC_SCALE\n-                            \"\" + c.getScale(),\n-                            // CHARACTER_SET_NAME\n-                            CHARACTER_SET_NAME,\n-                            // COLLATION_NAME\n-                            collation,\n-                            // TYPE_NAME\n-                            identifier(DataType.getDataType(c.getType()).name),\n-                            // NULLABLE\n-                            \"\" + (c.isNullable() ?\n-                                    DatabaseMetaData.columnNullable :\n-                                    DatabaseMetaData.columnNoNulls) ,\n-                            // IS_COMPUTED\n-                            \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n-                            // SELECTIVITY\n-                            \"\" + (c.getSelectivity()),\n-                            // CHECK_CONSTRAINT\n-                            c.getCheckConstraintSQL(session, c.getName()),\n-                            // SEQUENCE_NAME\n-                            sequence == null ? null : sequence.getName(),\n-                            // REMARKS\n-                            replaceNullWithEmpty(c.getComment()),\n-                            // SOURCE_DATA_TYPE\n-                            null\n-                    );\n-                }\n+          } else {\n+            storageType = table.isPersistIndexes() ?\n+                \"CACHED\" : \"MEMORY\";\n+          }\n+          String sql = table.getCreateSQL();\n+          if (!admin) {\n+            if (sql != null && sql.contains(JdbcSQLException.HIDE_SQL)) {\n+              // hide the password of linked tables\n+              sql = \"-\";\n             }\n-            break;\n+          }\n+          add(rows,\n+              // TABLE_CATALOG\n+              catalog,\n+              // TABLE_SCHEMA\n+              identifier(table.getSchema().getName()),\n+              // TABLE_NAME\n+              tableName,\n+              // TABLE_TYPE\n+              table.getTableType(),\n+              // STORAGE_TYPE\n+              storageType,\n+              // SQL\n+              sql,\n+              // REMARKS\n+              replaceNullWithEmpty(table.getComment()),\n+              // LAST_MODIFICATION\n+              \"\" + table.getMaxDataModificationId(),\n+              // ID\n+              \"\" + table.getId(),\n+              // TYPE_NAME\n+              null,\n+              // TABLE_CLASS\n+              table.getClass().getName(),\n+              // ROW_COUNT_ESTIMATE\n+              \"\" + table.getRowCountApproximation()\n+          );\n         }\n-        case INDEXES: {\n-            // reduce the number of tables to scan - makes some metadata queries\n-            // 10x faster\n-            final ArrayList<Table> tablesToList;\n-            if (indexFrom != null && indexTo != null && indexFrom.equals(indexTo)) {\n-                String tableName = identifier(indexFrom.getString());\n-                tablesToList = getTablesByName(session, tableName);\n-            } else {\n-                tablesToList = getAllTables(session);\n-            }\n-            for (Table table : tablesToList) {\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                if (hideTable(table, session)) {\n-                    continue;\n-                }\n-                ArrayList<Index> indexes = table.getIndexes();\n-                ArrayList<Constraint> constraints = table.getConstraints();\n-                for (int j = 0; indexes != null && j < indexes.size(); j++) {\n-                    Index index = indexes.get(j);\n-                    if (index.getCreateSQL() == null) {\n-                        continue;\n-                    }\n-                    String constraintName = null;\n-                    for (int k = 0; constraints != null && k < constraints.size(); k++) {\n-                        Constraint constraint = constraints.get(k);\n-                        if (constraint.usesIndex(index)) {\n-                            if (index.getIndexType().isPrimaryKey()) {\n-                                if (constraint.getConstraintType().equals(\n-                                        Constraint.PRIMARY_KEY)) {\n-                                    constraintName = constraint.getName();\n-                                }\n-                            } else {\n-                                constraintName = constraint.getName();\n-                            }\n-                        }\n-                    }\n-                    IndexColumn[] cols = index.getIndexColumns();\n-                    String indexClass;\n-                    if (index instanceof MultiVersionIndex) {\n-                        indexClass = ((MultiVersionIndex) index).\n-                                getBaseIndex().getClass().getName();\n-                    } else {\n-                        indexClass = index.getClass().getName();\n-                    }\n-                    for (int k = 0; k < cols.length; k++) {\n-                        IndexColumn idxCol = cols[k];\n-                        Column column = idxCol.column;\n-                        add(rows,\n-                                // TABLE_CATALOG\n-                                catalog,\n-                                // TABLE_SCHEMA\n-                                identifier(table.getSchema().getName()),\n-                                // TABLE_NAME\n-                                tableName,\n-                                // NON_UNIQUE\n-                                index.getIndexType().isUnique() ?\n-                                        \"FALSE\" : \"TRUE\",\n-                                // INDEX_NAME\n-                                identifier(index.getName()),\n-                                // ORDINAL_POSITION\n-                                \"\" + (k+1),\n-                                // COLUMN_NAME\n-                                identifier(column.getName()),\n-                                // CARDINALITY\n-                                \"0\",\n-                                // PRIMARY_KEY\n-                                index.getIndexType().isPrimaryKey() ?\n-                                        \"TRUE\" : \"FALSE\",\n-                                // INDEX_TYPE_NAME\n-                                index.getIndexType().getSQL(),\n-                                // IS_GENERATED\n-                                index.getIndexType().getBelongsToConstraint() ?\n-                                        \"TRUE\" : \"FALSE\",\n-                                // INDEX_TYPE\n-                                \"\" + DatabaseMetaData.tableIndexOther,\n-                                // ASC_OR_DESC\n-                                (idxCol.sortType & SortOrder.DESCENDING) != 0 ?\n-                                        \"D\" : \"A\",\n-                                // PAGES\n-                                \"0\",\n-                                // FILTER_CONDITION\n-                                \"\",\n-                                // REMARKS\n-                                replaceNullWithEmpty(index.getComment()),\n-                                // SQL\n-                                index.getCreateSQL(),\n-                                // ID\n-                                \"\" + index.getId(),\n-                                // SORT_TYPE\n-                                \"\" + idxCol.sortType,\n-                                // CONSTRAINT_NAME\n-                                constraintName,\n-                                // INDEX_CLASS\n-                                indexClass\n-                            );\n-                    }\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case COLUMNS: {\n+        // reduce the number of tables to scan - makes some metadata queries\n+        // 10x faster\n+        final ArrayList<Table> tablesToList;\n+        if (indexFrom != null && indexTo != null && indexFrom.equals(indexTo)) {\n+          String tableName = identifier(indexFrom.getString());\n+          tablesToList = getTablesByName(session, tableName);\n+        } else {\n+          tablesToList = getAllTables(session);\n         }\n-        case TABLE_TYPES: {\n-            add(rows, Table.TABLE);\n-            add(rows, Table.TABLE_LINK);\n-            add(rows, Table.SYSTEM_TABLE);\n-            add(rows, Table.VIEW);\n-            add(rows, Table.EXTERNAL_TABLE_ENGINE);\n-            break;\n+        for (Table table : tablesToList) {\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          if (hideTable(table, session)) {\n+            continue;\n+          }\n+          Column[] cols = table.getColumns();\n+          String collation = database.getCompareMode().getName();\n+          for (int j = 0; j < cols.length; j++) {\n+            Column c = cols[j];\n+            Sequence sequence = c.getSequence();\n+            add(rows,\n+                // TABLE_CATALOG\n+                catalog,\n+                // TABLE_SCHEMA\n+                identifier(table.getSchema().getName()),\n+                // TABLE_NAME\n+                tableName,\n+                // COLUMN_NAME\n+                identifier(c.getName()),\n+                // ORDINAL_POSITION\n+                String.valueOf(j + 1),\n+                // COLUMN_DEFAULT\n+                c.getDefaultSQL(),\n+                // IS_NULLABLE\n+                c.isNullable() ? \"YES\" : \"NO\",\n+                // DATA_TYPE\n+                \"\" + DataType.convertTypeToSQLType(c.getType()),\n+                // CHARACTER_MAXIMUM_LENGTH\n+                \"\" + c.getPrecisionAsInt(),\n+                // CHARACTER_OCTET_LENGTH\n+                \"\" + c.getPrecisionAsInt(),\n+                // NUMERIC_PRECISION\n+                \"\" + c.getPrecisionAsInt(),\n+                // NUMERIC_PRECISION_RADIX\n+                \"10\",\n+                // NUMERIC_SCALE\n+                \"\" + c.getScale(),\n+                // CHARACTER_SET_NAME\n+                CHARACTER_SET_NAME,\n+                // COLLATION_NAME\n+                collation,\n+                // TYPE_NAME\n+                identifier(DataType.getDataType(c.getType()).name),\n+                // NULLABLE\n+                \"\" + (c.isNullable() ?\n+                    DatabaseMetaData.columnNullable :\n+                    DatabaseMetaData.columnNoNulls),\n+                // IS_COMPUTED\n+                \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n+                // SELECTIVITY\n+                \"\" + (c.getSelectivity()),\n+                // CHECK_CONSTRAINT\n+                c.getCheckConstraintSQL(session, c.getName()),\n+                // SEQUENCE_NAME\n+                sequence == null ? null : sequence.getName(),\n+                // REMARKS\n+                replaceNullWithEmpty(c.getComment()),\n+                // SOURCE_DATA_TYPE\n+                null\n+            );\n+          }\n         }\n-        case CATALOGS: {\n-            add(rows, catalog);\n-            break;\n+        break;\n+      }\n+      case INDEXES: {\n+        // reduce the number of tables to scan - makes some metadata queries\n+        // 10x faster\n+        final ArrayList<Table> tablesToList;\n+        if (indexFrom != null && indexTo != null && indexFrom.equals(indexTo)) {\n+          String tableName = identifier(indexFrom.getString());\n+          tablesToList = getTablesByName(session, tableName);\n+        } else {\n+          tablesToList = getAllTables(session);\n         }\n-        case SETTINGS: {\n-            for (Setting s : database.getAllSettings()) {\n-                String value = s.getStringValue();\n-                if (value == null) {\n-                    value = \"\" + s.getIntValue();\n-                }\n-                add(rows,\n-                        identifier(s.getName()),\n-                        value\n-                );\n+        for (Table table : tablesToList) {\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          if (hideTable(table, session)) {\n+            continue;\n+          }\n+          ArrayList<Index> indexes = table.getIndexes();\n+          ArrayList<Constraint> constraints = table.getConstraints();\n+          for (int j = 0; indexes != null && j < indexes.size(); j++) {\n+            Index index = indexes.get(j);\n+            if (index.getCreateSQL() == null) {\n+              continue;\n             }\n-            add(rows, \"info.BUILD_ID\", \"\" + Constants.BUILD_ID);\n-            add(rows, \"info.VERSION_MAJOR\", \"\" + Constants.VERSION_MAJOR);\n-            add(rows, \"info.VERSION_MINOR\", \"\" + Constants.VERSION_MINOR);\n-            add(rows, \"info.VERSION\", \"\" + Constants.getFullVersion());\n-            if (admin) {\n-                String[] settings = {\n-                        \"java.runtime.version\", \"java.vm.name\",\n-                        \"java.vendor\", \"os.name\", \"os.arch\", \"os.version\",\n-                        \"sun.os.patch.level\", \"file.separator\",\n-                        \"path.separator\", \"line.separator\", \"user.country\",\n-                        \"user.language\", \"user.variant\", \"file.encoding\"                };\n-                for (String s : settings) {\n-                    add(rows, \"property.\" + s, Utils.getProperty(s, \"\"));\n+            String constraintName = null;\n+            for (int k = 0; constraints != null && k < constraints.size();\n+                 k++) {\n+              Constraint constraint = constraints.get(k);\n+              if (constraint.usesIndex(index)) {\n+                if (index.getIndexType().isPrimaryKey()) {\n+                  if (constraint.getConstraintType().equals(\n+                      Constraint.PRIMARY_KEY)) {\n+                    constraintName = constraint.getName();\n+                  }\n+                } else {\n+                  constraintName = constraint.getName();\n                 }\n+              }\n             }\n-            add(rows, \"EXCLUSIVE\", database.getExclusiveSession() == null ?\n-                    \"FALSE\" : \"TRUE\");\n-            add(rows, \"MODE\", database.getMode().getName());\n-            add(rows, \"MULTI_THREADED\", database.isMultiThreaded() ? \"1\" : \"0\");\n-            add(rows, \"MVCC\", database.isMultiVersion() ? \"TRUE\" : \"FALSE\");\n-            add(rows, \"QUERY_TIMEOUT\", \"\" + session.getQueryTimeout());\n-            add(rows, \"RETENTION_TIME\", \"\" + database.getRetentionTime());\n-            add(rows, \"LOG\", \"\" + database.getLogMode());\n-            // database settings\n-            ArrayList<String> settingNames = New.arrayList();\n-            HashMap<String, String> s = database.getSettings().getSettings();\n-            for (String k : s.keySet()) {\n-                settingNames.add(k);\n-            }\n-            Collections.sort(settingNames);\n-            for (String k : settingNames) {\n-                add(rows, k, s.get(k));\n+            IndexColumn[] cols = index.getIndexColumns();\n+            String indexClass;\n+            if (index instanceof MultiVersionIndex) {\n+              indexClass = ((MultiVersionIndex) index).\n+                  getBaseIndex().getClass().getName();\n+            } else {\n+              indexClass = index.getClass().getName();\n             }\n-            if (database.isPersistent()) {\n-                PageStore store = database.getPageStore();\n-                if (store != null) {\n-                    add(rows, \"info.FILE_WRITE_TOTAL\",\n-                            \"\" + store.getWriteCountTotal());\n-                    add(rows, \"info.FILE_WRITE\",\n-                            \"\" + store.getWriteCount());\n-                    add(rows, \"info.FILE_READ\",\n-                            \"\" + store.getReadCount());\n-                    add(rows, \"info.PAGE_COUNT\",\n-                            \"\" + store.getPageCount());\n-                    add(rows, \"info.PAGE_SIZE\",\n-                            \"\" + store.getPageSize());\n-                    add(rows, \"info.CACHE_MAX_SIZE\",\n-                            \"\" + store.getCache().getMaxMemory());\n-                    add(rows, \"info.CACHE_SIZE\",\n-                            \"\" + store.getCache().getMemory());\n-                }\n-                Store mvStore = database.getMvStore();\n-                if (mvStore != null) {\n-                    FileStore fs = mvStore.getStore().getFileStore();\n-                    add(rows, \"info.FILE_WRITE\", \"\" +\n-                            fs.getWriteCount());\n-                    add(rows, \"info.FILE_READ\", \"\" +\n-                            fs.getReadCount());\n-                    long size;\n-                    try {\n-                        size = fs.getFile().size();\n-                    } catch (IOException e) {\n-                        throw DbException.convertIOException(e, \"Can not get size\");\n-                    }\n-                    int pageSize = 4 * 1024;\n-                    long pageCount = size / pageSize;\n-                    add(rows, \"info.PAGE_COUNT\", \"\" +\n-                            pageCount);\n-                    add(rows, \"info.PAGE_SIZE\", \"\" +\n-                            pageSize);\n-                    add(rows, \"info.CACHE_MAX_SIZE\", \"\" +\n-                            mvStore.getStore().getCacheSize());\n-                    add(rows, \"info.CACHE_SIZE\", \"\" +\n-                            mvStore.getStore().getCacheSizeUsed());\n-                }\n+            for (int k = 0; k < cols.length; k++) {\n+              IndexColumn idxCol = cols[k];\n+              Column column = idxCol.column;\n+              add(rows,\n+                  // TABLE_CATALOG\n+                  catalog,\n+                  // TABLE_SCHEMA\n+                  identifier(table.getSchema().getName()),\n+                  // TABLE_NAME\n+                  tableName,\n+                  // NON_UNIQUE\n+                  index.getIndexType().isUnique() ?\n+                      \"FALSE\" : \"TRUE\",\n+                  // INDEX_NAME\n+                  identifier(index.getName()),\n+                  // ORDINAL_POSITION\n+                  \"\" + (k + 1),\n+                  // COLUMN_NAME\n+                  identifier(column.getName()),\n+                  // CARDINALITY\n+                  \"0\",\n+                  // PRIMARY_KEY\n+                  index.getIndexType().isPrimaryKey() ?\n+                      \"TRUE\" : \"FALSE\",\n+                  // INDEX_TYPE_NAME\n+                  index.getIndexType().getSQL(),\n+                  // IS_GENERATED\n+                  index.getIndexType().getBelongsToConstraint() ?\n+                      \"TRUE\" : \"FALSE\",\n+                  // INDEX_TYPE\n+                  \"\" + DatabaseMetaData.tableIndexOther,\n+                  // ASC_OR_DESC\n+                  (idxCol.sortType & SortOrder.DESCENDING) != 0 ?\n+                      \"D\" : \"A\",\n+                  // PAGES\n+                  \"0\",\n+                  // FILTER_CONDITION\n+                  \"\",\n+                  // REMARKS\n+                  replaceNullWithEmpty(index.getComment()),\n+                  // SQL\n+                  index.getCreateSQL(),\n+                  // ID\n+                  \"\" + index.getId(),\n+                  // SORT_TYPE\n+                  \"\" + idxCol.sortType,\n+                  // CONSTRAINT_NAME\n+                  constraintName,\n+                  // INDEX_CLASS\n+                  indexClass\n+              );\n             }\n-            break;\n+          }\n         }\n-        case TYPE_INFO: {\n-            for (DataType t : DataType.getTypes()) {\n-                if (t.hidden || t.sqlType == Value.NULL) {\n-                    continue;\n-                }\n-                add(rows,\n-                        // TYPE_NAME\n-                        t.name,\n-                        // DATA_TYPE\n-                        String.valueOf(t.sqlType),\n-                        // PRECISION\n-                        String.valueOf(MathUtils.convertLongToInt(t.maxPrecision)),\n-                        // PREFIX\n-                        t.prefix,\n-                        // SUFFIX\n-                        t.suffix,\n-                        // PARAMS\n-                        t.params,\n-                        // AUTO_INCREMENT\n-                        String.valueOf(t.autoIncrement),\n-                        // MINIMUM_SCALE\n-                        String.valueOf(t.minScale),\n-                        // MAXIMUM_SCALE\n-                        String.valueOf(t.maxScale),\n-                        // RADIX\n-                        t.decimal ? \"10\" : null,\n-                        // POS\n-                        String.valueOf(t.sqlTypePos),\n-                        // CASE_SENSITIVE\n-                        String.valueOf(t.caseSensitive),\n-                        // NULLABLE\n-                        \"\" + DatabaseMetaData.typeNullable,\n-                        // SEARCHABLE\n-                        \"\" + DatabaseMetaData.typeSearchable\n-                );\n-            }\n-            break;\n+        break;\n+      }\n+      case TABLE_TYPES: {\n+        add(rows, Table.TABLE);\n+        add(rows, Table.TABLE_LINK);\n+        add(rows, Table.SYSTEM_TABLE);\n+        add(rows, Table.VIEW);\n+        add(rows, Table.EXTERNAL_TABLE_ENGINE);\n+        break;\n+      }\n+      case CATALOGS: {\n+        add(rows, catalog);\n+        break;\n+      }\n+      case SETTINGS: {\n+        for (Setting s : database.getAllSettings()) {\n+          String value = s.getStringValue();\n+          if (value == null) {\n+            value = \"\" + s.getIntValue();\n+          }\n+          add(rows,\n+              identifier(s.getName()),\n+              value\n+          );\n+        }\n+        add(rows, \"info.BUILD_ID\", \"\" + Constants.BUILD_ID);\n+        add(rows, \"info.VERSION_MAJOR\", \"\" + Constants.VERSION_MAJOR);\n+        add(rows, \"info.VERSION_MINOR\", \"\" + Constants.VERSION_MINOR);\n+        add(rows, \"info.VERSION\", \"\" + Constants.getFullVersion());\n+        if (admin) {\n+          String[] settings = {\n+              \"java.runtime.version\", \"java.vm.name\",\n+              \"java.vendor\", \"os.name\", \"os.arch\", \"os.version\",\n+              \"sun.os.patch.level\", \"file.separator\",\n+              \"path.separator\", \"line.separator\", \"user.country\",\n+              \"user.language\", \"user.variant\", \"file.encoding\"};\n+          for (String s : settings) {\n+            add(rows, \"property.\" + s, Utils.getProperty(s, \"\"));\n+          }\n+        }\n+        add(rows, \"EXCLUSIVE\", database.getExclusiveSession() == null ?\n+            \"FALSE\" : \"TRUE\");\n+        add(rows, \"MODE\", database.getMode().getName());\n+        add(rows, \"MULTI_THREADED\", database.isMultiThreaded() ? \"1\" : \"0\");\n+        add(rows, \"MVCC\", database.isMultiVersion() ? \"TRUE\" : \"FALSE\");\n+        add(rows, \"QUERY_TIMEOUT\", \"\" + session.getQueryTimeout());\n+        add(rows, \"RETENTION_TIME\", \"\" + database.getRetentionTime());\n+        add(rows, \"LOG\", \"\" + database.getLogMode());\n+        // database settings\n+        ArrayList<String> settingNames = New.arrayList();\n+        HashMap<String, String> s = database.getSettings().getSettings();\n+        for (String k : s.keySet()) {\n+          settingNames.add(k);\n         }\n-        case HELP: {\n-            String resource = \"/org/h2/res/help.csv\";\n+        Collections.sort(settingNames);\n+        for (String k : settingNames) {\n+          add(rows, k, s.get(k));\n+        }\n+        if (database.isPersistent()) {\n+          PageStore store = database.getPageStore();\n+          if (store != null) {\n+            add(rows, \"info.FILE_WRITE_TOTAL\",\n+                \"\" + store.getWriteCountTotal());\n+            add(rows, \"info.FILE_WRITE\",\n+                \"\" + store.getWriteCount());\n+            add(rows, \"info.FILE_READ\",\n+                \"\" + store.getReadCount());\n+            add(rows, \"info.PAGE_COUNT\",\n+                \"\" + store.getPageCount());\n+            add(rows, \"info.PAGE_SIZE\",\n+                \"\" + store.getPageSize());\n+            add(rows, \"info.CACHE_MAX_SIZE\",\n+                \"\" + store.getCache().getMaxMemory());\n+            add(rows, \"info.CACHE_SIZE\",\n+                \"\" + store.getCache().getMemory());\n+          }\n+          Store mvStore = database.getMvStore();\n+          if (mvStore != null) {\n+            FileStore fs = mvStore.getStore().getFileStore();\n+            add(rows, \"info.FILE_WRITE\", \"\" +\n+                fs.getWriteCount());\n+            add(rows, \"info.FILE_READ\", \"\" +\n+                fs.getReadCount());\n+            long size;\n             try {\n-                byte[] data = Utils.getResource(resource);\n-                Reader reader = new InputStreamReader(\n-                        new ByteArrayInputStream(data));\n-                Csv csv = new Csv();\n-                csv.setLineCommentCharacter('#');\n-                ResultSet rs = csv.read(reader, null);\n-                for (int i = 0; rs.next(); i++) {\n-                    add(rows,\n-                        // ID\n-                        String.valueOf(i),\n-                        // SECTION\n-                        rs.getString(1).trim(),\n-                        // TOPIC\n-                        rs.getString(2).trim(),\n-                        // SYNTAX\n-                        rs.getString(3).trim(),\n-                        // TEXT\n-                        rs.getString(4).trim()\n-                    );\n-                }\n-            } catch (Exception e) {\n-                throw DbException.convert(e);\n+              size = fs.getFile().size();\n+            } catch (IOException e) {\n+              throw DbException.convertIOException(e, \"Can not get size\");\n             }\n-            break;\n+            int pageSize = 4 * 1024;\n+            long pageCount = size / pageSize;\n+            add(rows, \"info.PAGE_COUNT\", \"\" +\n+                pageCount);\n+            add(rows, \"info.PAGE_SIZE\", \"\" +\n+                pageSize);\n+            add(rows, \"info.CACHE_MAX_SIZE\", \"\" +\n+                mvStore.getStore().getCacheSize());\n+            add(rows, \"info.CACHE_SIZE\", \"\" +\n+                mvStore.getStore().getCacheSizeUsed());\n+          }\n         }\n-        case SEQUENCES: {\n-            for (SchemaObject obj : database.getAllSchemaObjects(\n-                    DbObject.SEQUENCE)) {\n-                Sequence s = (Sequence) obj;\n-                add(rows,\n-                        // SEQUENCE_CATALOG\n-                        catalog,\n-                        // SEQUENCE_SCHEMA\n-                        identifier(s.getSchema().getName()),\n-                        // SEQUENCE_NAME\n-                        identifier(s.getName()),\n-                        // CURRENT_VALUE\n-                        String.valueOf(s.getCurrentValue()),\n-                        // INCREMENT\n-                        String.valueOf(s.getIncrement()),\n-                        // IS_GENERATED\n-                        s.getBelongsToTable() ? \"TRUE\" : \"FALSE\",\n-                        // REMARKS\n-                        replaceNullWithEmpty(s.getComment()),\n-                        // CACHE\n-                        String.valueOf(s.getCacheSize()),\n-                        // MIN_VALUE\n-                        String.valueOf(s.getMinValue()),\n-                        // MAX_VALUE\n-                        String.valueOf(s.getMaxValue()),\n-                        // IS_CYCLE\n-                        s.getCycle() ? \"TRUE\" : \"FALSE\",\n-                        // ID\n-                        \"\" + s.getId()\n-                    );\n-            }\n-            break;\n+        break;\n+      }\n+      case TYPE_INFO: {\n+        for (DataType t : DataType.getTypes()) {\n+          if (t.hidden || t.sqlType == Value.NULL) {\n+            continue;\n+          }\n+          add(rows,\n+              // TYPE_NAME\n+              t.name,\n+              // DATA_TYPE\n+              String.valueOf(t.sqlType),\n+              // PRECISION\n+              String.valueOf(MathUtils.convertLongToInt(t.maxPrecision)),\n+              // PREFIX\n+              t.prefix,\n+              // SUFFIX\n+              t.suffix,\n+              // PARAMS\n+              t.params,\n+              // AUTO_INCREMENT\n+              String.valueOf(t.autoIncrement),\n+              // MINIMUM_SCALE\n+              String.valueOf(t.minScale),\n+              // MAXIMUM_SCALE\n+              String.valueOf(t.maxScale),\n+              // RADIX\n+              t.decimal ? \"10\" : null,\n+              // POS\n+              String.valueOf(t.sqlTypePos),\n+              // CASE_SENSITIVE\n+              String.valueOf(t.caseSensitive),\n+              // NULLABLE\n+              \"\" + DatabaseMetaData.typeNullable,\n+              // SEARCHABLE\n+              \"\" + DatabaseMetaData.typeSearchable\n+          );\n         }\n-        case USERS: {\n-            for (User u : database.getAllUsers()) {\n-                if (admin || session.getUser() == u) {\n-                    add(rows,\n-                            // NAME\n-                            identifier(u.getName()),\n-                            // ADMIN\n-                            String.valueOf(u.isAdmin()),\n-                            // REMARKS\n-                            replaceNullWithEmpty(u.getComment()),\n-                            // ID\n-                            \"\" + u.getId()\n-                    );\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case HELP: {\n+        String resource = \"/org/h2/res/help.csv\";\n+        try {\n+          byte[] data = Utils.getResource(resource);\n+          Reader reader = new InputStreamReader(\n+              new ByteArrayInputStream(data));\n+          Csv csv = new Csv();\n+          csv.setLineCommentCharacter('#');\n+          ResultSet rs = csv.read(reader, null);\n+          for (int i = 0; rs.next(); i++) {\n+            add(rows,\n+                // ID\n+                String.valueOf(i),\n+                // SECTION\n+                rs.getString(1).trim(),\n+                // TOPIC\n+                rs.getString(2).trim(),\n+                // SYNTAX\n+                rs.getString(3).trim(),\n+                // TEXT\n+                rs.getString(4).trim()\n+            );\n+          }\n+        } catch (Exception e) {\n+          throw DbException.convert(e);\n         }\n-        case ROLES: {\n-            for (Role r : database.getAllRoles()) {\n-                if (admin || session.getUser().isRoleGranted(r)) {\n-                    add(rows,\n-                            // NAME\n-                            identifier(r.getName()),\n-                            // REMARKS\n-                            replaceNullWithEmpty(r.getComment()),\n-                            // ID\n-                            \"\" + r.getId()\n-                    );\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case SEQUENCES: {\n+        for (SchemaObject obj : database.getAllSchemaObjects(\n+            DbObject.SEQUENCE)) {\n+          Sequence s = (Sequence) obj;\n+          add(rows,\n+              // SEQUENCE_CATALOG\n+              catalog,\n+              // SEQUENCE_SCHEMA\n+              identifier(s.getSchema().getName()),\n+              // SEQUENCE_NAME\n+              identifier(s.getName()),\n+              // CURRENT_VALUE\n+              String.valueOf(s.getCurrentValue()),\n+              // INCREMENT\n+              String.valueOf(s.getIncrement()),\n+              // IS_GENERATED\n+              s.getBelongsToTable() ? \"TRUE\" : \"FALSE\",\n+              // REMARKS\n+              replaceNullWithEmpty(s.getComment()),\n+              // CACHE\n+              String.valueOf(s.getCacheSize()),\n+              // MIN_VALUE\n+              String.valueOf(s.getMinValue()),\n+              // MAX_VALUE\n+              String.valueOf(s.getMaxValue()),\n+              // IS_CYCLE\n+              s.getCycle() ? \"TRUE\" : \"FALSE\",\n+              // ID\n+              \"\" + s.getId()\n+          );\n         }\n-        case RIGHTS: {\n-            if (admin) {\n-                for (Right r : database.getAllRights()) {\n-                    Role role = r.getGrantedRole();\n-                    DbObject grantee = r.getGrantee();\n-                    String rightType = grantee.getType() == DbObject.USER ?\n-                            \"USER\" : \"ROLE\";\n-                    if (role == null) {\n-                        DbObject object = r.getGrantedObject();\n-                        Schema schema = null;\n-                        Table table = null;\n-                        if (object != null) {\n-                            if (object instanceof Schema) {\n-                                schema = (Schema) object;\n-                            } else if (object instanceof Table) {\n-                                table = (Table) object;\n-                                schema = table.getSchema();\n-                            }\n-                        }\n-                        String tableName = (table != null) ? identifier(table.getName()) : \"\";\n-                        String schemaName = (schema != null) ? identifier(schema.getName()) : \"\";\n-                        if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                            continue;\n-                        }\n-                        add(rows,\n-                                // GRANTEE\n-                                identifier(grantee.getName()),\n-                                // GRANTEETYPE\n-                                rightType,\n-                                // GRANTEDROLE\n-                                \"\",\n-                                // RIGHTS\n-                                r.getRights(),\n-                                // TABLE_SCHEMA\n-                                schemaName,\n-                                // TABLE_NAME\n-                                tableName,\n-                                // ID\n-                                \"\" + r.getId()\n-                        );\n-                    } else {\n-                        add(rows,\n-                                // GRANTEE\n-                                identifier(grantee.getName()),\n-                                // GRANTEETYPE\n-                                rightType,\n-                                // GRANTEDROLE\n-                                identifier(role.getName()),\n-                                // RIGHTS\n-                                \"\",\n-                                // TABLE_SCHEMA\n-                                \"\",\n-                                // TABLE_NAME\n-                                \"\",\n-                                // ID\n-                                \"\" + r.getId()\n-                        );\n-                    }\n+        break;\n+      }\n+      case USERS: {\n+        for (User u : database.getAllUsers()) {\n+          if (admin || session.getUser() == u) {\n+            add(rows,\n+                // NAME\n+                identifier(u.getName()),\n+                // ADMIN\n+                String.valueOf(u.isAdmin()),\n+                // REMARKS\n+                replaceNullWithEmpty(u.getComment()),\n+                // ID\n+                \"\" + u.getId()\n+            );\n+          }\n+        }\n+        break;\n+      }\n+      case ROLES: {\n+        for (Role r : database.getAllRoles()) {\n+          if (admin || session.getUser().isRoleGranted(r)) {\n+            add(rows,\n+                // NAME\n+                identifier(r.getName()),\n+                // REMARKS\n+                replaceNullWithEmpty(r.getComment()),\n+                // ID\n+                \"\" + r.getId()\n+            );\n+          }\n+        }\n+        break;\n+      }\n+      case RIGHTS: {\n+        if (admin) {\n+          for (Right r : database.getAllRights()) {\n+            Role role = r.getGrantedRole();\n+            DbObject grantee = r.getGrantee();\n+            String rightType = grantee.getType() == DbObject.USER ?\n+                \"USER\" : \"ROLE\";\n+            if (role == null) {\n+              DbObject object = r.getGrantedObject();\n+              Schema schema = null;\n+              Table table = null;\n+              if (object != null) {\n+                if (object instanceof Schema) {\n+                  schema = (Schema) object;\n+                } else if (object instanceof Table) {\n+                  table = (Table) object;\n+                  schema = table.getSchema();\n                 }\n+              }\n+              String tableName =\n+                  (table != null) ? identifier(table.getName()) : \"\";\n+              String schemaName =\n+                  (schema != null) ? identifier(schema.getName()) : \"\";\n+              if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+                continue;\n+              }\n+              add(rows,\n+                  // GRANTEE\n+                  identifier(grantee.getName()),\n+                  // GRANTEETYPE\n+                  rightType,\n+                  // GRANTEDROLE\n+                  \"\",\n+                  // RIGHTS\n+                  r.getRights(),\n+                  // TABLE_SCHEMA\n+                  schemaName,\n+                  // TABLE_NAME\n+                  tableName,\n+                  // ID\n+                  \"\" + r.getId()\n+              );\n+            } else {\n+              add(rows,\n+                  // GRANTEE\n+                  identifier(grantee.getName()),\n+                  // GRANTEETYPE\n+                  rightType,\n+                  // GRANTEDROLE\n+                  identifier(role.getName()),\n+                  // RIGHTS\n+                  \"\",\n+                  // TABLE_SCHEMA\n+                  \"\",\n+                  // TABLE_NAME\n+                  \"\",\n+                  // ID\n+                  \"\" + r.getId()\n+              );\n             }\n-            break;\n+          }\n         }\n-        case FUNCTION_ALIASES: {\n-            for (SchemaObject aliasAsSchemaObject :\n-                    database.getAllSchemaObjects(DbObject.FUNCTION_ALIAS)) {\n-                FunctionAlias alias = (FunctionAlias) aliasAsSchemaObject;\n-                JavaMethod[] methods;\n-                try {\n-                    methods = alias.getJavaMethods();\n-                } catch (DbException e) {\n-                    methods = new JavaMethod[0];\n-                }\n-                for (FunctionAlias.JavaMethod method : methods) {\n-                    int returnsResult = method.getDataType() == Value.NULL ?\n-                            DatabaseMetaData.procedureNoResult :\n-                            DatabaseMetaData.procedureReturnsResult;\n-                    add(rows,\n-                            // ALIAS_CATALOG\n-                            catalog,\n-                            // ALIAS_SCHEMA\n-                            alias.getSchema().getName(),\n-                            // ALIAS_NAME\n-                            identifier(alias.getName()),\n-                            // JAVA_CLASS\n-                            alias.getJavaClassName(),\n-                            // JAVA_METHOD\n-                            alias.getJavaMethodName(),\n-                            // DATA_TYPE\n-                            \"\" + DataType.convertTypeToSQLType(method.getDataType()),\n-                            // TYPE_NAME\n-                            DataType.getDataType(method.getDataType()).name,\n-                            // COLUMN_COUNT INT\n-                            \"\" + method.getParameterCount(),\n-                            // RETURNS_RESULT SMALLINT\n-                            \"\" + returnsResult,\n-                            // REMARKS\n-                            replaceNullWithEmpty(alias.getComment()),\n-                            // ID\n-                            \"\" + alias.getId(),\n-                            // SOURCE\n-                            alias.getSource()\n-                            // when adding more columns, see also below\n-                    );\n-                }\n+        break;\n+      }\n+      case FUNCTION_ALIASES: {\n+        for (SchemaObject aliasAsSchemaObject :\n+            database.getAllSchemaObjects(DbObject.FUNCTION_ALIAS)) {\n+          FunctionAlias alias = (FunctionAlias) aliasAsSchemaObject;\n+          JavaMethod[] methods;\n+          try {\n+            methods = alias.getJavaMethods();\n+          } catch (DbException e) {\n+            methods = new JavaMethod[0];\n+          }\n+          for (FunctionAlias.JavaMethod method : methods) {\n+            int returnsResult = method.getDataType() == Value.NULL ?\n+                DatabaseMetaData.procedureNoResult :\n+                DatabaseMetaData.procedureReturnsResult;\n+            add(rows,\n+                // ALIAS_CATALOG\n+                catalog,\n+                // ALIAS_SCHEMA\n+                alias.getSchema().getName(),\n+                // ALIAS_NAME\n+                identifier(alias.getName()),\n+                // JAVA_CLASS\n+                alias.getJavaClassName(),\n+                // JAVA_METHOD\n+                alias.getJavaMethodName(),\n+                // DATA_TYPE\n+                \"\" + DataType.convertTypeToSQLType(method.getDataType()),\n+                // TYPE_NAME\n+                DataType.getDataType(method.getDataType()).name,\n+                // COLUMN_COUNT INT\n+                \"\" + method.getParameterCount(),\n+                // RETURNS_RESULT SMALLINT\n+                \"\" + returnsResult,\n+                // REMARKS\n+                replaceNullWithEmpty(alias.getComment()),\n+                // ID\n+                \"\" + alias.getId(),\n+                // SOURCE\n+                alias.getSource()\n+                // when adding more columns, see also below\n+            );\n+          }\n+        }\n+        for (UserAggregate agg : database.getAllAggregates()) {\n+          int returnsResult = DatabaseMetaData.procedureReturnsResult;\n+          add(rows,\n+              // ALIAS_CATALOG\n+              catalog,\n+              // ALIAS_SCHEMA\n+              Constants.SCHEMA_MAIN,\n+              // ALIAS_NAME\n+              identifier(agg.getName()),\n+              // JAVA_CLASS\n+              agg.getJavaClassName(),\n+              // JAVA_METHOD\n+              \"\",\n+              // DATA_TYPE\n+              \"\" + DataType.convertTypeToSQLType(Value.NULL),\n+              // TYPE_NAME\n+              DataType.getDataType(Value.NULL).name,\n+              // COLUMN_COUNT INT\n+              \"1\",\n+              // RETURNS_RESULT SMALLINT\n+              \"\" + returnsResult,\n+              // REMARKS\n+              replaceNullWithEmpty(agg.getComment()),\n+              // ID\n+              \"\" + agg.getId(),\n+              // SOURCE\n+              \"\"\n+              // when adding more columns, see also below\n+          );\n+        }\n+        break;\n+      }\n+      case FUNCTION_COLUMNS: {\n+        for (SchemaObject aliasAsSchemaObject :\n+            database.getAllSchemaObjects(DbObject.FUNCTION_ALIAS)) {\n+          FunctionAlias alias = (FunctionAlias) aliasAsSchemaObject;\n+          JavaMethod[] methods;\n+          try {\n+            methods = alias.getJavaMethods();\n+          } catch (DbException e) {\n+            methods = new JavaMethod[0];\n+          }\n+          for (FunctionAlias.JavaMethod method : methods) {\n+            // Add return column index 0\n+            if (method.getDataType() != Value.NULL) {\n+              DataType dt = DataType.getDataType(method.getDataType());\n+              add(rows,\n+                  // ALIAS_CATALOG\n+                  catalog,\n+                  // ALIAS_SCHEMA\n+                  alias.getSchema().getName(),\n+                  // ALIAS_NAME\n+                  identifier(alias.getName()),\n+                  // JAVA_CLASS\n+                  alias.getJavaClassName(),\n+                  // JAVA_METHOD\n+                  alias.getJavaMethodName(),\n+                  // COLUMN_COUNT\n+                  \"\" + method.getParameterCount(),\n+                  // POS INT\n+                  \"0\",\n+                  // COLUMN_NAME\n+                  \"P0\",\n+                  // DATA_TYPE\n+                  \"\" + DataType.convertTypeToSQLType(method.getDataType()),\n+                  // TYPE_NAME\n+                  dt.name,\n+                  // PRECISION INT\n+                  \"\" + MathUtils.convertLongToInt(dt.defaultPrecision),\n+                  // SCALE\n+                  \"\" + dt.defaultScale,\n+                  // RADIX\n+                  \"10\",\n+                  // NULLABLE SMALLINT\n+                  \"\" + DatabaseMetaData.columnNullableUnknown,\n+                  // COLUMN_TYPE\n+                  \"\" + DatabaseMetaData.procedureColumnReturn,\n+                  // REMARKS\n+                  \"\",\n+                  // COLUMN_DEFAULT\n+                  null\n+              );\n             }\n-            for (UserAggregate agg : database.getAllAggregates()) {\n-                int returnsResult = DatabaseMetaData.procedureReturnsResult;\n-                add(rows,\n-                        // ALIAS_CATALOG\n-                        catalog,\n-                        // ALIAS_SCHEMA\n-                        Constants.SCHEMA_MAIN,\n-                        // ALIAS_NAME\n-                        identifier(agg.getName()),\n-                        // JAVA_CLASS\n-                        agg.getJavaClassName(),\n-                        // JAVA_METHOD\n-                        \"\",\n-                        // DATA_TYPE\n-                        \"\" + DataType.convertTypeToSQLType(Value.NULL),\n-                        // TYPE_NAME\n-                        DataType.getDataType(Value.NULL).name,\n-                        // COLUMN_COUNT INT\n-                        \"1\",\n-                        // RETURNS_RESULT SMALLINT\n-                        \"\" + returnsResult,\n-                        // REMARKS\n-                        replaceNullWithEmpty(agg.getComment()),\n-                        // ID\n-                        \"\" + agg.getId(),\n-                        // SOURCE\n-                        \"\"\n-                        // when adding more columns, see also below\n-                );\n+            Class<?>[] columnList = method.getColumnClasses();\n+            for (int k = 0; k < columnList.length; k++) {\n+              if (method.hasConnectionParam() && k == 0) {\n+                continue;\n+              }\n+              Class<?> clazz = columnList[k];\n+              int dataType = DataType.getTypeFromClass(clazz);\n+              DataType dt = DataType.getDataType(dataType);\n+              int nullable =\n+                  clazz.isPrimitive() ? DatabaseMetaData.columnNoNulls\n+                      : DatabaseMetaData.columnNullable;\n+              add(rows,\n+                  // ALIAS_CATALOG\n+                  catalog,\n+                  // ALIAS_SCHEMA\n+                  alias.getSchema().getName(),\n+                  // ALIAS_NAME\n+                  identifier(alias.getName()),\n+                  // JAVA_CLASS\n+                  alias.getJavaClassName(),\n+                  // JAVA_METHOD\n+                  alias.getJavaMethodName(),\n+                  // COLUMN_COUNT\n+                  \"\" + method.getParameterCount(),\n+                  // POS INT\n+                  \"\" + (k + (method.hasConnectionParam() ? 0 : 1)),\n+                  // COLUMN_NAME\n+                  \"P\" + (k + 1),\n+                  // DATA_TYPE\n+                  \"\" + DataType.convertTypeToSQLType(dt.type),\n+                  // TYPE_NAME\n+                  dt.name,\n+                  // PRECISION INT\n+                  \"\" + MathUtils.convertLongToInt(dt.defaultPrecision),\n+                  // SCALE\n+                  \"\" + dt.defaultScale,\n+                  // RADIX\n+                  \"10\",\n+                  // NULLABLE SMALLINT\n+                  \"\" + nullable,\n+                  // COLUMN_TYPE\n+                  \"\" + DatabaseMetaData.procedureColumnIn,\n+                  // REMARKS\n+                  \"\",\n+                  // COLUMN_DEFAULT\n+                  null\n+              );\n             }\n-            break;\n+          }\n         }\n-        case FUNCTION_COLUMNS: {\n-            for (SchemaObject aliasAsSchemaObject :\n-                    database.getAllSchemaObjects(DbObject.FUNCTION_ALIAS)) {\n-                FunctionAlias alias = (FunctionAlias) aliasAsSchemaObject;\n-                JavaMethod[] methods;\n-                try {\n-                    methods = alias.getJavaMethods();\n-                } catch (DbException e) {\n-                    methods = new JavaMethod[0];\n-                }\n-                for (FunctionAlias.JavaMethod method : methods) {\n-                    // Add return column index 0\n-                    if (method.getDataType() != Value.NULL) {\n-                        DataType dt = DataType.getDataType(method.getDataType());\n-                        add(rows,\n-                                // ALIAS_CATALOG\n-                                catalog,\n-                                // ALIAS_SCHEMA\n-                                alias.getSchema().getName(),\n-                                // ALIAS_NAME\n-                                identifier(alias.getName()),\n-                                // JAVA_CLASS\n-                                alias.getJavaClassName(),\n-                                // JAVA_METHOD\n-                                alias.getJavaMethodName(),\n-                                // COLUMN_COUNT\n-                                \"\" + method.getParameterCount(),\n-                                // POS INT\n-                                \"0\",\n-                                // COLUMN_NAME\n-                                \"P0\",\n-                                // DATA_TYPE\n-                                \"\" + DataType.convertTypeToSQLType(method.getDataType()),\n-                                // TYPE_NAME\n-                                dt.name,\n-                                // PRECISION INT\n-                                \"\" + MathUtils.convertLongToInt(dt.defaultPrecision),\n-                                // SCALE\n-                                \"\" + dt.defaultScale,\n-                                // RADIX\n-                                \"10\",\n-                                // NULLABLE SMALLINT\n-                                \"\" + DatabaseMetaData.columnNullableUnknown,\n-                                // COLUMN_TYPE\n-                                \"\" + DatabaseMetaData.procedureColumnReturn,\n-                                // REMARKS\n-                                \"\",\n-                                // COLUMN_DEFAULT\n-                                null\n-                        );\n-                    }\n-                    Class<?>[] columnList = method.getColumnClasses();\n-                    for (int k = 0; k < columnList.length; k++) {\n-                        if (method.hasConnectionParam() && k == 0) {\n-                            continue;\n-                        }\n-                        Class<?> clazz = columnList[k];\n-                        int dataType = DataType.getTypeFromClass(clazz);\n-                        DataType dt = DataType.getDataType(dataType);\n-                        int nullable = clazz.isPrimitive() ? DatabaseMetaData.columnNoNulls\n-                                : DatabaseMetaData.columnNullable;\n-                        add(rows,\n-                                // ALIAS_CATALOG\n-                                catalog,\n-                                // ALIAS_SCHEMA\n-                                alias.getSchema().getName(),\n-                                // ALIAS_NAME\n-                                identifier(alias.getName()),\n-                                // JAVA_CLASS\n-                                alias.getJavaClassName(),\n-                                // JAVA_METHOD\n-                                alias.getJavaMethodName(),\n-                                // COLUMN_COUNT\n-                                \"\" + method.getParameterCount(),\n-                                // POS INT\n-                                \"\" + (k + (method.hasConnectionParam() ? 0 : 1)),\n-                                // COLUMN_NAME\n-                                \"P\" + (k + 1),\n-                                // DATA_TYPE\n-                                \"\" + DataType.convertTypeToSQLType(dt.type),\n-                                // TYPE_NAME\n-                                dt.name,\n-                                // PRECISION INT\n-                                \"\" + MathUtils.convertLongToInt(dt.defaultPrecision),\n-                                // SCALE\n-                                \"\" + dt.defaultScale,\n-                                // RADIX\n-                                \"10\",\n-                                // NULLABLE SMALLINT\n-                                \"\" + nullable,\n-                                // COLUMN_TYPE\n-                                \"\" + DatabaseMetaData.procedureColumnIn,\n-                                // REMARKS\n-                                \"\",\n-                                // COLUMN_DEFAULT\n-                                null\n-                        );\n-                    }\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case SCHEMATA: {\n+        String collation = database.getCompareMode().getName();\n+        for (Schema schema : database.getAllSchemas()) {\n+          add(rows,\n+              // CATALOG_NAME\n+              catalog,\n+              // SCHEMA_NAME\n+              identifier(schema.getName()),\n+              // SCHEMA_OWNER\n+              identifier(schema.getOwner().getName()),\n+              // DEFAULT_CHARACTER_SET_NAME\n+              CHARACTER_SET_NAME,\n+              // DEFAULT_COLLATION_NAME\n+              collation,\n+              // IS_DEFAULT\n+              Constants.SCHEMA_MAIN.equals(\n+                  schema.getName()) ? \"TRUE\" : \"FALSE\",\n+              // REMARKS\n+              replaceNullWithEmpty(schema.getComment()),\n+              // ID\n+              \"\" + schema.getId()\n+          );\n         }\n-        case SCHEMATA: {\n-            String collation = database.getCompareMode().getName();\n-            for (Schema schema : database.getAllSchemas()) {\n-                add(rows,\n-                        // CATALOG_NAME\n-                        catalog,\n-                        // SCHEMA_NAME\n-                        identifier(schema.getName()),\n-                        // SCHEMA_OWNER\n-                        identifier(schema.getOwner().getName()),\n-                        // DEFAULT_CHARACTER_SET_NAME\n-                        CHARACTER_SET_NAME,\n-                        // DEFAULT_COLLATION_NAME\n-                        collation,\n-                        // IS_DEFAULT\n-                        Constants.SCHEMA_MAIN.equals(\n-                                schema.getName()) ? \"TRUE\" : \"FALSE\",\n-                        // REMARKS\n-                        replaceNullWithEmpty(schema.getComment()),\n-                        // ID\n-                        \"\" + schema.getId()\n-                );\n-            }\n-            break;\n+        break;\n+      }\n+      case TABLE_PRIVILEGES: {\n+        for (Right r : database.getAllRights()) {\n+          DbObject object = r.getGrantedObject();\n+          if (!(object instanceof Table)) {\n+            continue;\n+          }\n+          Table table = (Table) object;\n+          if (table == null || hideTable(table, session)) {\n+            continue;\n+          }\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          addPrivileges(rows, r.getGrantee(), catalog, table, null,\n+              r.getRightMask());\n         }\n-        case TABLE_PRIVILEGES: {\n-            for (Right r : database.getAllRights()) {\n-                DbObject object = r.getGrantedObject();\n-                if (!(object instanceof Table)) {\n-                    continue;\n-                }\n-                Table table = (Table) object;\n-                if (table == null || hideTable(table, session)) {\n-                    continue;\n-                }\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                addPrivileges(rows, r.getGrantee(), catalog, table, null,\n-                        r.getRightMask());\n-            }\n-            break;\n+        break;\n+      }\n+      case COLUMN_PRIVILEGES: {\n+        for (Right r : database.getAllRights()) {\n+          DbObject object = r.getGrantedObject();\n+          if (!(object instanceof Table)) {\n+            continue;\n+          }\n+          Table table = (Table) object;\n+          if (table == null || hideTable(table, session)) {\n+            continue;\n+          }\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          DbObject grantee = r.getGrantee();\n+          int mask = r.getRightMask();\n+          for (Column column : table.getColumns()) {\n+            addPrivileges(rows, grantee, catalog, table,\n+                column.getName(), mask);\n+          }\n         }\n-        case COLUMN_PRIVILEGES: {\n-            for (Right r : database.getAllRights()) {\n-                DbObject object = r.getGrantedObject();\n-                if (!(object instanceof Table)) {\n-                    continue;\n-                }\n-                Table table = (Table) object;\n-                if (table == null || hideTable(table, session)) {\n-                    continue;\n-                }\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                DbObject grantee = r.getGrantee();\n-                int mask = r.getRightMask();\n-                for (Column column : table.getColumns()) {\n-                    addPrivileges(rows, grantee, catalog, table,\n-                            column.getName(), mask);\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case COLLATIONS: {\n+        for (Locale l : Collator.getAvailableLocales()) {\n+          add(rows,\n+              // NAME\n+              CompareMode.getName(l),\n+              // KEY\n+              l.toString()\n+          );\n         }\n-        case COLLATIONS: {\n-            for (Locale l : Collator.getAvailableLocales()) {\n-                add(rows,\n-                        // NAME\n-                        CompareMode.getName(l),\n-                        // KEY\n-                        l.toString()\n-                );\n-            }\n-            break;\n+        break;\n+      }\n+      case VIEWS: {\n+        for (Table table : getAllTables(session)) {\n+          if (!table.getTableType().equals(Table.VIEW)) {\n+            continue;\n+          }\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          TableView view = (TableView) table;\n+          add(rows,\n+              // TABLE_CATALOG\n+              catalog,\n+              // TABLE_SCHEMA\n+              identifier(table.getSchema().getName()),\n+              // TABLE_NAME\n+              tableName,\n+              // VIEW_DEFINITION\n+              table.getCreateSQL(),\n+              // CHECK_OPTION\n+              \"NONE\",\n+              // IS_UPDATABLE\n+              \"NO\",\n+              // STATUS\n+              view.isInvalid() ? \"INVALID\" : \"VALID\",\n+              // REMARKS\n+              replaceNullWithEmpty(view.getComment()),\n+              // ID\n+              \"\" + view.getId()\n+          );\n         }\n-        case VIEWS: {\n-            for (Table table : getAllTables(session)) {\n-                if (!table.getTableType().equals(Table.VIEW)) {\n-                    continue;\n-                }\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                TableView view = (TableView) table;\n-                add(rows,\n-                        // TABLE_CATALOG\n-                        catalog,\n-                        // TABLE_SCHEMA\n-                        identifier(table.getSchema().getName()),\n-                        // TABLE_NAME\n-                        tableName,\n-                        // VIEW_DEFINITION\n-                        table.getCreateSQL(),\n-                        // CHECK_OPTION\n-                        \"NONE\",\n-                        // IS_UPDATABLE\n-                        \"NO\",\n-                        // STATUS\n-                        view.isInvalid() ? \"INVALID\" : \"VALID\",\n-                        // REMARKS\n-                        replaceNullWithEmpty(view.getComment()),\n-                        // ID\n-                        \"\" + view.getId()\n-                );\n-            }\n-            break;\n+        break;\n+      }\n+      case IN_DOUBT: {\n+        ArrayList<InDoubtTransaction> prepared =\n+            database.getInDoubtTransactions();\n+        if (prepared != null && admin) {\n+          for (InDoubtTransaction prep : prepared) {\n+            add(rows,\n+                // TRANSACTION\n+                prep.getTransactionName(),\n+                // STATE\n+                prep.getState()\n+            );\n+          }\n         }\n-        case IN_DOUBT: {\n-            ArrayList<InDoubtTransaction> prepared = database.getInDoubtTransactions();\n-            if (prepared != null && admin) {\n-                for (InDoubtTransaction prep : prepared) {\n-                    add(rows,\n-                            // TRANSACTION\n-                            prep.getTransactionName(),\n-                            // STATE\n-                            prep.getState()\n-                    );\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case CROSS_REFERENCES: {\n+        for (SchemaObject obj : database.getAllSchemaObjects(\n+            DbObject.CONSTRAINT)) {\n+          Constraint constraint = (Constraint) obj;\n+          if (!(constraint.getConstraintType()\n+              .equals(Constraint.REFERENTIAL))) {\n+            continue;\n+          }\n+          ConstraintReferential ref = (ConstraintReferential) constraint;\n+          IndexColumn[] cols = ref.getColumns();\n+          IndexColumn[] refCols = ref.getRefColumns();\n+          Table tab = ref.getTable();\n+          Table refTab = ref.getRefTable();\n+          String tableName = identifier(refTab.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          int update = getRefAction(ref.getUpdateAction());\n+          int delete = getRefAction(ref.getDeleteAction());\n+          for (int j = 0; j < cols.length; j++) {\n+            add(rows,\n+                // PKTABLE_CATALOG\n+                catalog,\n+                // PKTABLE_SCHEMA\n+                identifier(refTab.getSchema().getName()),\n+                // PKTABLE_NAME\n+                identifier(refTab.getName()),\n+                // PKCOLUMN_NAME\n+                identifier(refCols[j].column.getName()),\n+                // FKTABLE_CATALOG\n+                catalog,\n+                // FKTABLE_SCHEMA\n+                identifier(tab.getSchema().getName()),\n+                // FKTABLE_NAME\n+                identifier(tab.getName()),\n+                // FKCOLUMN_NAME\n+                identifier(cols[j].column.getName()),\n+                // ORDINAL_POSITION\n+                String.valueOf(j + 1),\n+                // UPDATE_RULE SMALLINT\n+                String.valueOf(update),\n+                // DELETE_RULE SMALLINT\n+                String.valueOf(delete),\n+                // FK_NAME\n+                identifier(ref.getName()),\n+                // PK_NAME\n+                identifier(ref.getUniqueIndex().getName()),\n+                // DEFERRABILITY\n+                \"\" + DatabaseMetaData.importedKeyNotDeferrable\n+            );\n+          }\n         }\n-        case CROSS_REFERENCES: {\n-            for (SchemaObject obj : database.getAllSchemaObjects(\n-                    DbObject.CONSTRAINT)) {\n-                Constraint constraint = (Constraint) obj;\n-                if (!(constraint.getConstraintType().equals(Constraint.REFERENTIAL))) {\n-                    continue;\n-                }\n-                ConstraintReferential ref = (ConstraintReferential) constraint;\n-                IndexColumn[] cols = ref.getColumns();\n-                IndexColumn[] refCols = ref.getRefColumns();\n-                Table tab = ref.getTable();\n-                Table refTab = ref.getRefTable();\n-                String tableName = identifier(refTab.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                int update = getRefAction(ref.getUpdateAction());\n-                int delete = getRefAction(ref.getDeleteAction());\n-                for (int j = 0; j < cols.length; j++) {\n-                    add(rows,\n-                            // PKTABLE_CATALOG\n-                            catalog,\n-                            // PKTABLE_SCHEMA\n-                            identifier(refTab.getSchema().getName()),\n-                            // PKTABLE_NAME\n-                            identifier(refTab.getName()),\n-                            // PKCOLUMN_NAME\n-                            identifier(refCols[j].column.getName()),\n-                            // FKTABLE_CATALOG\n-                            catalog,\n-                            // FKTABLE_SCHEMA\n-                            identifier(tab.getSchema().getName()),\n-                            // FKTABLE_NAME\n-                            identifier(tab.getName()),\n-                            // FKCOLUMN_NAME\n-                            identifier(cols[j].column.getName()),\n-                            // ORDINAL_POSITION\n-                            String.valueOf(j + 1),\n-                            // UPDATE_RULE SMALLINT\n-                            String.valueOf(update),\n-                            // DELETE_RULE SMALLINT\n-                            String.valueOf(delete),\n-                            // FK_NAME\n-                            identifier(ref.getName()),\n-                            // PK_NAME\n-                            identifier(ref.getUniqueIndex().getName()),\n-                            // DEFERRABILITY\n-                            \"\" + DatabaseMetaData.importedKeyNotDeferrable\n-                    );\n-                }\n+        break;\n+      }\n+      case CONSTRAINTS: {\n+        for (SchemaObject obj : database.getAllSchemaObjects(\n+            DbObject.CONSTRAINT)) {\n+          Constraint constraint = (Constraint) obj;\n+          String constraintType = constraint.getConstraintType();\n+          String checkExpression = null;\n+          IndexColumn[] indexColumns = null;\n+          Table table = constraint.getTable();\n+          if (hideTable(table, session)) {\n+            continue;\n+          }\n+          Index index = constraint.getUniqueIndex();\n+          String uniqueIndexName = null;\n+          if (index != null) {\n+            uniqueIndexName = index.getName();\n+          }\n+          String tableName = identifier(table.getName());\n+          if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n+            continue;\n+          }\n+          if (constraintType.equals(Constraint.CHECK)) {\n+            checkExpression =\n+                ((ConstraintCheck) constraint).getExpression().getSQL();\n+          } else if (constraintType.equals(Constraint.UNIQUE) ||\n+              constraintType.equals(Constraint.PRIMARY_KEY)) {\n+            indexColumns = ((ConstraintUnique) constraint).getColumns();\n+          } else if (constraintType.equals(Constraint.REFERENTIAL)) {\n+            indexColumns = ((ConstraintReferential) constraint).getColumns();\n+          }\n+          String columnList = null;\n+          if (indexColumns != null) {\n+            StatementBuilder buff = new StatementBuilder();\n+            for (IndexColumn col : indexColumns) {\n+              buff.appendExceptFirst(\",\");\n+              buff.append(col.column.getName());\n             }\n-            break;\n+            columnList = buff.toString();\n+          }\n+          add(rows,\n+              // CONSTRAINT_CATALOG\n+              catalog,\n+              // CONSTRAINT_SCHEMA\n+              identifier(constraint.getSchema().getName()),\n+              // CONSTRAINT_NAME\n+              identifier(constraint.getName()),\n+              // CONSTRAINT_TYPE\n+              constraintType,\n+              // TABLE_CATALOG\n+              catalog,\n+              // TABLE_SCHEMA\n+              identifier(table.getSchema().getName()),\n+              // TABLE_NAME\n+              tableName,\n+              // UNIQUE_INDEX_NAME\n+              uniqueIndexName,\n+              // CHECK_EXPRESSION\n+              checkExpression,\n+              // COLUMN_LIST\n+              columnList,\n+              // REMARKS\n+              replaceNullWithEmpty(constraint.getComment()),\n+              // SQL\n+              constraint.getCreateSQL(),\n+              // ID\n+              \"\" + constraint.getId()\n+          );\n         }\n-        case CONSTRAINTS: {\n-            for (SchemaObject obj : database.getAllSchemaObjects(\n-                    DbObject.CONSTRAINT)) {\n-                Constraint constraint = (Constraint) obj;\n-                String constraintType = constraint.getConstraintType();\n-                String checkExpression = null;\n-                IndexColumn[] indexColumns = null;\n-                Table table = constraint.getTable();\n-                if (hideTable(table, session)) {\n-                    continue;\n-                }\n-                Index index = constraint.getUniqueIndex();\n-                String uniqueIndexName = null;\n-                if (index != null) {\n-                    uniqueIndexName = index.getName();\n-                }\n-                String tableName = identifier(table.getName());\n-                if (!checkIndex(session, tableName, indexFrom, indexTo)) {\n-                    continue;\n-                }\n-                if (constraintType.equals(Constraint.CHECK)) {\n-                    checkExpression = ((ConstraintCheck) constraint).getExpression().getSQL();\n-                } else if (constraintType.equals(Constraint.UNIQUE) ||\n-                        constraintType.equals(Constraint.PRIMARY_KEY)) {\n-                    indexColumns = ((ConstraintUnique) constraint).getColumns();\n-                } else if (constraintType.equals(Constraint.REFERENTIAL)) {\n-                    indexColumns = ((ConstraintReferential) constraint).getColumns();\n-                }\n-                String columnList = null;\n-                if (indexColumns != null) {\n-                    StatementBuilder buff = new StatementBuilder();\n-                    for (IndexColumn col : indexColumns) {\n-                        buff.appendExceptFirst(\",\");\n-                        buff.append(col.column.getName());\n-                    }\n-                    columnList = buff.toString();\n-                }\n-                add(rows,\n-                        // CONSTRAINT_CATALOG\n-                        catalog,\n-                        // CONSTRAINT_SCHEMA\n-                        identifier(constraint.getSchema().getName()),\n-                        // CONSTRAINT_NAME\n-                        identifier(constraint.getName()),\n-                        // CONSTRAINT_TYPE\n-                        constraintType,\n-                        // TABLE_CATALOG\n-                        catalog,\n-                        // TABLE_SCHEMA\n-                        identifier(table.getSchema().getName()),\n-                        // TABLE_NAME\n-                        tableName,\n-                        // UNIQUE_INDEX_NAME\n-                        uniqueIndexName,\n-                        // CHECK_EXPRESSION\n-                        checkExpression,\n-                        // COLUMN_LIST\n-                        columnList,\n-                        // REMARKS\n-                        replaceNullWithEmpty(constraint.getComment()),\n-                        // SQL\n-                        constraint.getCreateSQL(),\n-                        // ID\n-                        \"\" + constraint.getId()\n-                    );\n-            }\n-            break;\n+        break;\n+      }\n+      case CONSTANTS: {\n+        for (SchemaObject obj : database.getAllSchemaObjects(\n+            DbObject.CONSTANT)) {\n+          Constant constant = (Constant) obj;\n+          ValueExpression expr = constant.getValue();\n+          add(rows,\n+              // CONSTANT_CATALOG\n+              catalog,\n+              // CONSTANT_SCHEMA\n+              identifier(constant.getSchema().getName()),\n+              // CONSTANT_NAME\n+              identifier(constant.getName()),\n+              // CONSTANT_TYPE\n+              \"\" + DataType.convertTypeToSQLType(expr.getType()),\n+              // REMARKS\n+              replaceNullWithEmpty(constant.getComment()),\n+              // SQL\n+              expr.getSQL(),\n+              // ID\n+              \"\" + constant.getId()\n+          );\n         }\n-        case CONSTANTS: {\n-            for (SchemaObject obj : database.getAllSchemaObjects(\n-                    DbObject.CONSTANT)) {\n-                Constant constant = (Constant) obj;\n-                ValueExpression expr = constant.getValue();\n-                add(rows,\n-                        // CONSTANT_CATALOG\n-                        catalog,\n-                        // CONSTANT_SCHEMA\n-                        identifier(constant.getSchema().getName()),\n-                        // CONSTANT_NAME\n-                        identifier(constant.getName()),\n-                        // CONSTANT_TYPE\n-                        \"\" + DataType.convertTypeToSQLType(expr.getType()),\n-                        // REMARKS\n-                        replaceNullWithEmpty(constant.getComment()),\n-                        // SQL\n-                        expr.getSQL(),\n-                        // ID\n-                        \"\" + constant.getId()\n-                    );\n-            }\n-            break;\n+        break;\n+      }\n+      case DOMAINS: {\n+        for (UserDataType dt : database.getAllUserDataTypes()) {\n+          Column col = dt.getColumn();\n+          add(rows,\n+              // DOMAIN_CATALOG\n+              catalog,\n+              // DOMAIN_SCHEMA\n+              Constants.SCHEMA_MAIN,\n+              // DOMAIN_NAME\n+              identifier(dt.getName()),\n+              // COLUMN_DEFAULT\n+              col.getDefaultSQL(),\n+              // IS_NULLABLE\n+              col.isNullable() ? \"YES\" : \"NO\",\n+              // DATA_TYPE\n+              \"\" + col.getDataType().sqlType,\n+              // PRECISION INT\n+              \"\" + col.getPrecisionAsInt(),\n+              // SCALE INT\n+              \"\" + col.getScale(),\n+              // TYPE_NAME\n+              col.getDataType().name,\n+              // SELECTIVITY INT\n+              \"\" + col.getSelectivity(),\n+              // CHECK_CONSTRAINT\n+              \"\" + col.getCheckConstraintSQL(session, \"VALUE\"),\n+              // REMARKS\n+              replaceNullWithEmpty(dt.getComment()),\n+              // SQL\n+              \"\" + dt.getCreateSQL(),\n+              // ID\n+              \"\" + dt.getId()\n+          );\n         }\n-        case DOMAINS: {\n-            for (UserDataType dt : database.getAllUserDataTypes()) {\n-                Column col = dt.getColumn();\n-                add(rows,\n-                        // DOMAIN_CATALOG\n-                        catalog,\n-                        // DOMAIN_SCHEMA\n-                        Constants.SCHEMA_MAIN,\n-                        // DOMAIN_NAME\n-                        identifier(dt.getName()),\n-                        // COLUMN_DEFAULT\n-                        col.getDefaultSQL(),\n-                        // IS_NULLABLE\n-                        col.isNullable() ? \"YES\" : \"NO\",\n-                        // DATA_TYPE\n-                        \"\" + col.getDataType().sqlType,\n-                        // PRECISION INT\n-                        \"\" + col.getPrecisionAsInt(),\n-                        // SCALE INT\n-                        \"\" + col.getScale(),\n-                        // TYPE_NAME\n-                        col.getDataType().name,\n-                        // SELECTIVITY INT\n-                        \"\" + col.getSelectivity(),\n-                        // CHECK_CONSTRAINT\n-                        \"\" + col.getCheckConstraintSQL(session, \"VALUE\"),\n-                        // REMARKS\n-                        replaceNullWithEmpty(dt.getComment()),\n-                        // SQL\n-                        \"\" + dt.getCreateSQL(),\n-                        // ID\n-                        \"\" + dt.getId()\n-                );\n-            }\n-            break;\n+        break;\n+      }\n+      case TRIGGERS: {\n+        for (SchemaObject obj : database.getAllSchemaObjects(\n+            DbObject.TRIGGER)) {\n+          TriggerObject trigger = (TriggerObject) obj;\n+          Table table = trigger.getTable();\n+          add(rows,\n+              // TRIGGER_CATALOG\n+              catalog,\n+              // TRIGGER_SCHEMA\n+              identifier(trigger.getSchema().getName()),\n+              // TRIGGER_NAME\n+              identifier(trigger.getName()),\n+              // TRIGGER_TYPE\n+              trigger.getTypeNameList(),\n+              // TABLE_CATALOG\n+              catalog,\n+              // TABLE_SCHEMA\n+              identifier(table.getSchema().getName()),\n+              // TABLE_NAME\n+              identifier(table.getName()),\n+              // BEFORE BIT\n+              \"\" + trigger.isBefore(),\n+              // JAVA_CLASS\n+              trigger.getTriggerClassName(),\n+              // QUEUE_SIZE INT\n+              \"\" + trigger.getQueueSize(),\n+              // NO_WAIT BIT\n+              \"\" + trigger.isNoWait(),\n+              // REMARKS\n+              replaceNullWithEmpty(trigger.getComment()),\n+              // SQL\n+              trigger.getCreateSQL(),\n+              // ID\n+              \"\" + trigger.getId()\n+          );\n         }\n-        case TRIGGERS: {\n-            for (SchemaObject obj : database.getAllSchemaObjects(\n-                    DbObject.TRIGGER)) {\n-                TriggerObject trigger = (TriggerObject) obj;\n-                Table table = trigger.getTable();\n-                add(rows,\n-                        // TRIGGER_CATALOG\n-                        catalog,\n-                        // TRIGGER_SCHEMA\n-                        identifier(trigger.getSchema().getName()),\n-                        // TRIGGER_NAME\n-                        identifier(trigger.getName()),\n-                        // TRIGGER_TYPE\n-                        trigger.getTypeNameList(),\n-                        // TABLE_CATALOG\n-                        catalog,\n-                        // TABLE_SCHEMA\n-                        identifier(table.getSchema().getName()),\n-                        // TABLE_NAME\n-                        identifier(table.getName()),\n-                        // BEFORE BIT\n-                        \"\" + trigger.isBefore(),\n-                        // JAVA_CLASS\n-                        trigger.getTriggerClassName(),\n-                        // QUEUE_SIZE INT\n-                        \"\" + trigger.getQueueSize(),\n-                        // NO_WAIT BIT\n-                        \"\" + trigger.isNoWait(),\n-                        // REMARKS\n-                        replaceNullWithEmpty(trigger.getComment()),\n-                        // SQL\n-                        trigger.getCreateSQL(),\n-                        // ID\n-                        \"\" + trigger.getId()\n-                );\n+        break;\n+      }\n+      case SESSIONS: {\n+        long now = System.currentTimeMillis();\n+        for (Session s : database.getSessions(false)) {\n+          if (admin || s == session) {\n+            Command command = s.getCurrentCommand();\n+            long start = s.getCurrentCommandStart();\n+            if (start == 0) {\n+              start = now;\n             }\n-            break;\n+            add(rows,\n+                // ID\n+                \"\" + s.getId(),\n+                // USER_NAME\n+                s.getUser().getName(),\n+                // SESSION_START\n+                new Timestamp(s.getSessionStart()).toString(),\n+                // STATEMENT\n+                command == null ? null : command.toString(),\n+                // STATEMENT_START\n+                new Timestamp(start).toString(),\n+                // CONTAINS_UNCOMMITTED\n+                \"\" + s.containsUncommitted()\n+            );\n+          }\n         }\n-        case SESSIONS: {\n-            long now = System.currentTimeMillis();\n-            for (Session s : database.getSessions(false)) {\n-                if (admin || s == session) {\n-                    Command command = s.getCurrentCommand();\n-                    long start = s.getCurrentCommandStart();\n-                    if (start == 0) {\n-                        start = now;\n-                    }\n-                    add(rows,\n-                            // ID\n-                            \"\" + s.getId(),\n-                            // USER_NAME\n-                            s.getUser().getName(),\n-                            // SESSION_START\n-                            new Timestamp(s.getSessionStart()).toString(),\n-                            // STATEMENT\n-                            command == null ? null : command.toString(),\n-                            // STATEMENT_START\n-                            new Timestamp(start).toString(),\n-                            // CONTAINS_UNCOMMITTED\n-                            \"\" + s.containsUncommitted()\n-                    );\n-                }\n+        break;\n+      }\n+      case LOCKS: {\n+        for (Session s : database.getSessions(false)) {\n+          if (admin || s == session) {\n+            for (Table table : s.getLocks()) {\n+              add(rows,\n+                  // TABLE_SCHEMA\n+                  table.getSchema().getName(),\n+                  // TABLE_NAME\n+                  table.getName(),\n+                  // SESSION_ID\n+                  \"\" + s.getId(),\n+                  // LOCK_TYPE\n+                  table.isLockedExclusivelyBy(s) ? \"WRITE\" : \"READ\"\n+              );\n             }\n-            break;\n+          }\n         }\n-        case LOCKS: {\n-            for (Session s : database.getSessions(false)) {\n-                if (admin || s == session) {\n-                    for (Table table : s.getLocks()) {\n-                        add(rows,\n-                                // TABLE_SCHEMA\n-                                table.getSchema().getName(),\n-                                // TABLE_NAME\n-                                table.getName(),\n-                                // SESSION_ID\n-                                \"\" + s.getId(),\n-                                // LOCK_TYPE\n-                                table.isLockedExclusivelyBy(s) ? \"WRITE\" : \"READ\"\n-                        );\n-                    }\n-                }\n-            }\n-            break;\n+        break;\n+      }\n+      case SESSION_STATE: {\n+        for (String name : session.getVariableNames()) {\n+          Value v = session.getVariable(name);\n+          add(rows,\n+              // KEY\n+              \"@\" + name,\n+              // SQL\n+              \"SET @\" + name + \" \" + v.getSQL()\n+          );\n         }\n-        case SESSION_STATE: {\n-            for (String name : session.getVariableNames()) {\n-                Value v = session.getVariable(name);\n-                add(rows,\n-                        // KEY\n-                        \"@\" + name,\n-                        // SQL\n-                        \"SET @\" + name + \" \" + v.getSQL()\n-                );\n-            }\n-            for (Table table : session.getLocalTempTables()) {\n-                add(rows,\n-                        // KEY\n-                        \"TABLE \" + table.getName(),\n-                        // SQL\n-                        table.getCreateSQL()\n-                );\n-            }\n-            String[] path = session.getSchemaSearchPath();\n-            if (path != null && path.length > 0) {\n-                StatementBuilder buff = new StatementBuilder(\n-                        \"SET SCHEMA_SEARCH_PATH \");\n-                for (String p : path) {\n-                    buff.appendExceptFirst(\", \");\n-                    buff.append(StringUtils.quoteIdentifier(p));\n-                }\n-                add(rows,\n-                        // KEY\n-                        \"SCHEMA_SEARCH_PATH\",\n-                        // SQL\n-                        buff.toString()\n-                );\n-            }\n-            String schema = session.getCurrentSchemaName();\n-            if (schema != null) {\n-                add(rows,\n-                        // KEY\n-                        \"SCHEMA\",\n-                        // SQL\n-                        \"SET SCHEMA \" + StringUtils.quoteIdentifier(schema)\n-                );\n-            }\n-            break;\n+        for (Table table : session.getLocalTempTables()) {\n+          add(rows,\n+              // KEY\n+              \"TABLE \" + table.getName(),\n+              // SQL\n+              table.getCreateSQL()\n+          );\n         }\n-        case QUERY_STATISTICS: {\n-            QueryStatisticsData control = database.getQueryStatisticsData();\n-            if (control != null) {\n-                for (QueryStatisticsData.QueryEntry entry : control.getQueries()) {\n-                    add(rows,\n-                            // SQL_STATEMENT\n-                            entry.sqlStatement,\n-                            // EXECUTION_COUNT\n-                            \"\" + entry.count,\n-                            // MIN_EXECUTION_TIME\n-                            \"\" + entry.executionTimeMin,\n-                            // MAX_EXECUTION_TIME\n-                            \"\" + entry.executionTimeMax,\n-                            // CUMULATIVE_EXECUTION_TIME\n-                            \"\" + entry.executionTimeCumulative,\n-                            // AVERAGE_EXECUTION_TIME\n-                            \"\" + entry.executionTimeMean,\n-                            // STD_DEV_EXECUTION_TIME\n-                            \"\" + entry.getExecutionTimeStandardDeviation(),\n-                            // MIN_ROW_COUNT\n-                            \"\" + entry.rowCountMin,\n-                            // MAX_ROW_COUNT\n-                            \"\" + entry.rowCountMax,\n-                            // CUMULATIVE_ROW_COUNT\n-                            \"\" + entry.rowCountCumulative,\n-                            // AVERAGE_ROW_COUNT\n-                            \"\" + entry.rowCountMean,\n-                            // STD_DEV_ROW_COUNT\n-                            \"\" + entry.getRowCountStandardDeviation()\n-                    );\n-                }\n-            }\n-            break;\n+        String[] path = session.getSchemaSearchPath();\n+        if (path != null && path.length > 0) {\n+          StatementBuilder buff = new StatementBuilder(\n+              \"SET SCHEMA_SEARCH_PATH \");\n+          for (String p : path) {\n+            buff.appendExceptFirst(\", \");\n+            buff.append(StringUtils.quoteIdentifier(p));\n+          }\n+          add(rows,\n+              // KEY\n+              \"SCHEMA_SEARCH_PATH\",\n+              // SQL\n+              buff.toString()\n+          );\n         }\n-        default:\n-            DbException.throwInternalError(\"type=\"+type);\n+        String schema = session.getCurrentSchemaName();\n+        if (schema != null) {\n+          add(rows,\n+              // KEY\n+              \"SCHEMA\",\n+              // SQL\n+              \"SET SCHEMA \" + StringUtils.quoteIdentifier(schema)\n+          );\n         }\n-        return rows;\n-    }\n-\n-    private static int getRefAction(int action) {\n-        switch (action) {\n-        case ConstraintReferential.CASCADE:\n-            return DatabaseMetaData.importedKeyCascade;\n-        case ConstraintReferential.RESTRICT:\n-            return DatabaseMetaData.importedKeyRestrict;\n-        case ConstraintReferential.SET_DEFAULT:\n-            return DatabaseMetaData.importedKeySetDefault;\n-        case ConstraintReferential.SET_NULL:\n-            return DatabaseMetaData.importedKeySetNull;\n-        default:\n-            throw DbException.throwInternalError(\"action=\"+action);\n+        break;\n+      }\n+      case QUERY_STATISTICS: {\n+        QueryStatisticsData control = database.getQueryStatisticsData();\n+        if (control != null) {\n+          for (QueryStatisticsData.QueryEntry entry : control.getQueries()) {\n+            add(rows,\n+                // SQL_STATEMENT\n+                entry.sqlStatement,\n+                // EXECUTION_COUNT\n+                \"\" + entry.count,\n+                // MIN_EXECUTION_TIME\n+                \"\" + entry.executionTimeMin,\n+                // MAX_EXECUTION_TIME\n+                \"\" + entry.executionTimeMax,\n+                // CUMULATIVE_EXECUTION_TIME\n+                \"\" + entry.executionTimeCumulative,\n+                // AVERAGE_EXECUTION_TIME\n+                \"\" + entry.executionTimeMean,\n+                // STD_DEV_EXECUTION_TIME\n+                \"\" + entry.getExecutionTimeStandardDeviation(),\n+                // MIN_ROW_COUNT\n+                \"\" + entry.rowCountMin,\n+                // MAX_ROW_COUNT\n+                \"\" + entry.rowCountMax,\n+                // CUMULATIVE_ROW_COUNT\n+                \"\" + entry.rowCountCumulative,\n+                // AVERAGE_ROW_COUNT\n+                \"\" + entry.rowCountMean,\n+                // STD_DEV_ROW_COUNT\n+                \"\" + entry.getRowCountStandardDeviation()\n+            );\n+          }\n         }\n+        break;\n+      }\n+      default:\n+        DbException.throwInternalError(\"type=\" + type);\n     }\n+    return rows;\n+  }\n \n-    @Override\n-    public void removeRow(Session session, Row row) {\n-        throw DbException.getUnsupportedException(\"META\");\n+  private static int getRefAction(int action) {\n+    switch (action) {\n+      case ConstraintReferential.CASCADE:\n+        return DatabaseMetaData.importedKeyCascade;\n+      case ConstraintReferential.RESTRICT:\n+        return DatabaseMetaData.importedKeyRestrict;\n+      case ConstraintReferential.SET_DEFAULT:\n+        return DatabaseMetaData.importedKeySetDefault;\n+      case ConstraintReferential.SET_NULL:\n+        return DatabaseMetaData.importedKeySetNull;\n+      default:\n+        throw DbException.throwInternalError(\"action=\" + action);\n     }\n+  }\n \n-    @Override\n-    public void addRow(Session session, Row row) {\n-        throw DbException.getUnsupportedException(\"META\");\n-    }\n+  @Override\n+  public void removeRow(Session session, Row row) {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public void removeChildrenAndResources(Session session) {\n-        throw DbException.getUnsupportedException(\"META\");\n-    }\n+  @Override\n+  public void addRow(Session session, Row row) {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public void close(Session session) {\n-        // nothing to do\n-    }\n+  @Override\n+  public void removeChildrenAndResources(Session session) {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public void unlock(Session s) {\n-        // nothing to do\n-    }\n+  @Override\n+  public void close(Session session) {\n+    // nothing to do\n+  }\n \n-    private void addPrivileges(ArrayList<Row> rows, DbObject grantee,\n-            String catalog, Table table, String column, int rightMask) {\n-        if ((rightMask & Right.SELECT) != 0) {\n-            addPrivilege(rows, grantee, catalog, table, column, \"SELECT\");\n-        }\n-        if ((rightMask & Right.INSERT) != 0) {\n-            addPrivilege(rows, grantee, catalog, table, column, \"INSERT\");\n-        }\n-        if ((rightMask & Right.UPDATE) != 0) {\n-            addPrivilege(rows, grantee, catalog, table, column, \"UPDATE\");\n-        }\n-        if ((rightMask & Right.DELETE) != 0) {\n-            addPrivilege(rows, grantee, catalog, table, column, \"DELETE\");\n-        }\n-    }\n+  @Override\n+  public void unlock(Session s) {\n+    // nothing to do\n+  }\n \n-    private void addPrivilege(ArrayList<Row> rows, DbObject grantee,\n-            String catalog, Table table, String column, String right) {\n-        String isGrantable = \"NO\";\n-        if (grantee.getType() == DbObject.USER) {\n-            User user = (User) grantee;\n-            if (user.isAdmin()) {\n-                // the right is grantable if the grantee is an admin\n-                isGrantable = \"YES\";\n-            }\n-        }\n-        if (column == null) {\n-            add(rows,\n-                    // GRANTOR\n-                    null,\n-                    // GRANTEE\n-                    identifier(grantee.getName()),\n-                    // TABLE_CATALOG\n-                    catalog,\n-                    // TABLE_SCHEMA\n-                    identifier(table.getSchema().getName()),\n-                    // TABLE_NAME\n-                    identifier(table.getName()),\n-                    // PRIVILEGE_TYPE\n-                    right,\n-                    // IS_GRANTABLE\n-                    isGrantable\n-            );\n-        } else {\n-            add(rows,\n-                    // GRANTOR\n-                    null,\n-                    // GRANTEE\n-                    identifier(grantee.getName()),\n-                    // TABLE_CATALOG\n-                    catalog,\n-                    // TABLE_SCHEMA\n-                    identifier(table.getSchema().getName()),\n-                    // TABLE_NAME\n-                    identifier(table.getName()),\n-                    // COLUMN_NAME\n-                    identifier(column),\n-                    // PRIVILEGE_TYPE\n-                    right,\n-                    // IS_GRANTABLE\n-                    isGrantable\n-            );\n-        }\n+  private void addPrivileges(ArrayList<Row> rows, DbObject grantee,\n+                             String catalog, Table table, String column,\n+                             int rightMask) {\n+    if ((rightMask & Right.SELECT) != 0) {\n+      addPrivilege(rows, grantee, catalog, table, column, \"SELECT\");\n     }\n-\n-    private void add(ArrayList<Row> rows, String... strings) {\n-        Value[] values = new Value[strings.length];\n-        for (int i = 0; i < strings.length; i++) {\n-            String s = strings[i];\n-            Value v = (s == null) ? (Value) ValueNull.INSTANCE : ValueString.get(s);\n-            Column col = columns[i];\n-            v = col.convert(v);\n-            values[i] = v;\n-        }\n-        Row row = database.createRow(values, 1);\n-        row.setKey(rows.size());\n-        rows.add(row);\n+    if ((rightMask & Right.INSERT) != 0) {\n+      addPrivilege(rows, grantee, catalog, table, column, \"INSERT\");\n     }\n-\n-    @Override\n-    public void checkRename() {\n-        throw DbException.getUnsupportedException(\"META\");\n+    if ((rightMask & Right.UPDATE) != 0) {\n+      addPrivilege(rows, grantee, catalog, table, column, \"UPDATE\");\n     }\n-\n-    @Override\n-    public void checkSupportAlter() {\n-        throw DbException.getUnsupportedException(\"META\");\n+    if ((rightMask & Right.DELETE) != 0) {\n+      addPrivilege(rows, grantee, catalog, table, column, \"DELETE\");\n     }\n+  }\n \n-    @Override\n-    public void truncate(Session session) {\n-        throw DbException.getUnsupportedException(\"META\");\n+  private void addPrivilege(ArrayList<Row> rows, DbObject grantee,\n+                            String catalog, Table table, String column,\n+                            String right) {\n+    String isGrantable = \"NO\";\n+    if (grantee.getType() == DbObject.USER) {\n+      User user = (User) grantee;\n+      if (user.isAdmin()) {\n+        // the right is grantable if the grantee is an admin\n+        isGrantable = \"YES\";\n+      }\n     }\n-\n-    @Override\n-    public long getRowCount(Session session) {\n-        throw DbException.throwInternalError();\n+    if (column == null) {\n+      add(rows,\n+          // GRANTOR\n+          null,\n+          // GRANTEE\n+          identifier(grantee.getName()),\n+          // TABLE_CATALOG\n+          catalog,\n+          // TABLE_SCHEMA\n+          identifier(table.getSchema().getName()),\n+          // TABLE_NAME\n+          identifier(table.getName()),\n+          // PRIVILEGE_TYPE\n+          right,\n+          // IS_GRANTABLE\n+          isGrantable\n+      );\n+    } else {\n+      add(rows,\n+          // GRANTOR\n+          null,\n+          // GRANTEE\n+          identifier(grantee.getName()),\n+          // TABLE_CATALOG\n+          catalog,\n+          // TABLE_SCHEMA\n+          identifier(table.getSchema().getName()),\n+          // TABLE_NAME\n+          identifier(table.getName()),\n+          // COLUMN_NAME\n+          identifier(column),\n+          // PRIVILEGE_TYPE\n+          right,\n+          // IS_GRANTABLE\n+          isGrantable\n+      );\n     }\n+  }\n \n-    @Override\n-    public boolean canGetRowCount() {\n-        return false;\n+  private void add(ArrayList<Row> rows, String... strings) {\n+    Value[] values = new Value[strings.length];\n+    for (int i = 0; i < strings.length; i++) {\n+      String s = strings[i];\n+      Value v = (s == null) ? (Value) ValueNull.INSTANCE : ValueString.get(s);\n+      Column col = columns[i];\n+      v = col.convert(v);\n+      values[i] = v;\n     }\n+    Row row = database.createRow(values, 1);\n+    row.setKey(rows.size());\n+    rows.add(row);\n+  }\n \n-    @Override\n-    public boolean canDrop() {\n-        return false;\n-    }\n+  @Override\n+  public void checkRename() {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public String getTableType() {\n-        return Table.SYSTEM_TABLE;\n-    }\n+  @Override\n+  public void checkSupportAlter() {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public Index getScanIndex(Session session) {\n-        return new MetaIndex(this, IndexColumn.wrap(columns), true);\n-    }\n+  @Override\n+  public void truncate(Session session) {\n+    throw DbException.getUnsupportedException(\"META\");\n+  }\n \n-    @Override\n-    public ArrayList<Index> getIndexes() {\n-        ArrayList<Index> list = New.arrayList();\n-        if (metaIndex == null) {\n-            return list;\n-        }\n-        list.add(new MetaIndex(this, IndexColumn.wrap(columns), true));\n-        // TODO re-use the index\n-        list.add(metaIndex);\n-        return list;\n-    }\n+  @Override\n+  public long getRowCount(Session session) {\n+    throw DbException.throwInternalError();\n+  }\n \n-    @Override\n-    public long getMaxDataModificationId() {\n-        switch (type) {\n-        case SETTINGS:\n-        case IN_DOUBT:\n-        case SESSIONS:\n-        case LOCKS:\n-        case SESSION_STATE:\n-            return Long.MAX_VALUE;\n-        }\n-        return database.getModificationDataId();\n-    }\n+  @Override\n+  public boolean canGetRowCount() {\n+    return false;\n+  }\n \n-    @Override\n-    public Index getUniqueIndex() {\n-        return null;\n-    }\n+  @Override\n+  public boolean canDrop() {\n+    return false;\n+  }\n \n-    /**\n-     * Get the number of meta table types. Supported meta table\n-     * types are 0 .. this value - 1.\n-     *\n-     * @return the number of meta table types\n-     */\n-    public static int getMetaTableTypeCount() {\n-        return META_TABLE_TYPE_COUNT;\n-    }\n+  @Override\n+  public String getTableType() {\n+    return Table.SYSTEM_TABLE;\n+  }\n \n-    @Override\n-    public long getRowCountApproximation() {\n-        return ROW_COUNT_APPROXIMATION;\n-    }\n+  @Override\n+  public Index getScanIndex(Session session) {\n+    return new MetaIndex(this, IndexColumn.wrap(columns), true);\n+  }\n \n-    @Override\n-    public long getDiskSpaceUsed() {\n-        return 0;\n+  @Override\n+  public ArrayList<Index> getIndexes() {\n+    ArrayList<Index> list = New.arrayList();\n+    if (metaIndex == null) {\n+      return list;\n     }\n+    list.add(new MetaIndex(this, IndexColumn.wrap(columns), true));\n+    // TODO re-use the index\n+    list.add(metaIndex);\n+    return list;\n+  }\n \n-    @Override\n-    public boolean isDeterministic() {\n-        return true;\n+  @Override\n+  public long getMaxDataModificationId() {\n+    switch (type) {\n+      case SETTINGS:\n+      case IN_DOUBT:\n+      case SESSIONS:\n+      case LOCKS:\n+      case SESSION_STATE:\n+        return Long.MAX_VALUE;\n     }\n+    return database.getModificationDataId();\n+  }\n \n-    @Override\n-    public boolean canReference() {\n-        return false;\n-    }\n+  @Override\n+  public Index getUniqueIndex() {\n+    return null;\n+  }\n+\n+  /**\n+   * Get the number of meta table types. Supported meta table\n+   * types are 0 .. this value - 1.\n+   *\n+   * @return the number of meta table types\n+   */\n+  public static int getMetaTableTypeCount() {\n+    return META_TABLE_TYPE_COUNT;\n+  }\n+\n+  @Override\n+  public long getRowCountApproximation() {\n+    return ROW_COUNT_APPROXIMATION;\n+  }\n+\n+  @Override\n+  public long getDiskSpaceUsed() {\n+    return 0;\n+  }\n+\n+  @Override\n+  public boolean isDeterministic() {\n+    return true;\n+  }\n+\n+  @Override\n+  public boolean canReference() {\n+    return false;\n+  }\n \n }\n",
            "diff_size": 2546
        },
        {
            "tool": "naturalize",
            "errors": null,
            "diff": null
        },
        {
            "tool": "codebuff",
            "errors": null,
            "diff": null
        },
        {
            "tool": "styler_random",
            "errors": [],
            "diff": "diff --git a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler_random/58/MetaTable.java\nindex e9dc5d4d9e..6e517f3ee0 100644\n--- a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java\n+++ b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler_random/58/MetaTable.java\n@@ -798,7 +798,7 @@ public class MetaTable extends Table {\n                             // NULLABLE\n                             \"\" + (c.isNullable() ?\n                                     DatabaseMetaData.columnNullable :\n-                                    DatabaseMetaData.columnNoNulls) ,\n+                                    DatabaseMetaData.columnNoNulls),\n                             // IS_COMPUTED\n                             \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n                             // SELECTIVITY\n",
            "diff_size": 1
        },
        {
            "tool": "styler_three_grams",
            "errors": [],
            "diff": "diff --git a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler_three_grams/58/MetaTable.java\nindex e9dc5d4d9e..6e517f3ee0 100644\n--- a/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/errored/1/58/MetaTable.java\n+++ b/home/thomas/mnt/fernanda/styler-test2/python/./experiments/projects/../results/h2database-h2database/styler_three_grams/58/MetaTable.java\n@@ -798,7 +798,7 @@ public class MetaTable extends Table {\n                             // NULLABLE\n                             \"\" + (c.isNullable() ?\n                                     DatabaseMetaData.columnNullable :\n-                                    DatabaseMetaData.columnNoNulls) ,\n+                                    DatabaseMetaData.columnNoNulls),\n                             // IS_COMPUTED\n                             \"\" + (c.getComputed() ? \"TRUE\" : \"FALSE\"),\n                             // SELECTIVITY\n",
            "diff_size": 1
        }
    ]
}